<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>dk - Tag - Dokyung&#39;s DevOoOps</title>
        <link>https://huntedhappy.github.io/ko/tags/dk/</link>
        <description>dk - Tag - Dokyung&#39;s DevOoOps</description>
        <generator>Hugo -- gohugo.io</generator><language>ko</language><managingEditor>huntedhappy@gmail.com (Dokyung)</managingEditor>
            <webMaster>huntedhappy@gmail.com (Dokyung)</webMaster><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sun, 29 Jan 2023 21:55:28 &#43;0900</lastBuildDate><atom:link href="https://huntedhappy.github.io/ko/tags/dk/" rel="self" type="application/rss+xml" /><item>
    <title>Tap install on Openshift</title>
    <link>https://huntedhappy.github.io/ko/tapandopenshift/</link>
    <pubDate>Sun, 29 Jan 2023 21:55:28 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/tapandopenshift/</guid>
    <description><![CDATA[<h2 id="1-tanzu-application-platform-on-openshift">1. TANZU APPLICATION PLATFORM ON OPENSHIFT</h2>
<p>Tanzu Application Platform은 VMware에서 제공하는 CI/CD 솔루션입니다. 기본 VMware제품들은 대부분 VMware 솔루션에 Dependency가 있었습니다. 
그러나 TAP의 경우는 어떤 K8S 환경이면 어디든 설치가 된다는 컨셉으로 나온 것이 아닌가 싶습니다. 
1.3.x 부터 OPENSHIFT에서도 지원을 한다고 해서 한번 설치를 진행 해 보았으며 어떻게 설치를 할 수 있는지 한번 알아 보도록 하겠습니다.</p>
<p>기본적으로 OPENSHIFT는 설치가 되어 있다는 것을 가정으로 TAP를 설치를 진행을 하겠습니다.
참고로 OPENSHIFT의 경우 TAP에서 지원하는 것은 4.10 , 4.11 두가지를 지원 합니다.</p>
<figure><figcaption>
            <h4>ocp 지원 버전</h4>
        </figcaption>
</figure>

<p><figure><figcaption>
            <h4>ocp 설치 버전</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>ocp 설치 버전</h4>
        </figcaption>
</figure>
</p>
<blockquote>
<p>설치 버전</p>
<ul>
<li>Openshift Version 4.11.9</li>
<li>Tanzu Application Platform 1.4.0</li>
<li>TBS 1.9.0</li>
<li>AVI 22.1.2</li>
</ul>
</blockquote>
<blockquote>
<p>처음에 Openshift를 통해 TAP를 배포하려고 하다 보니 여러가지 이슈가 발생했는대, 해결이 안되는 부분이 AVI 그러니까 외부 로드밸런서를 사용하지 않고 Openshift가 가지고 있는 Ingress를 사용하려고 했는대 실패를 하였다. 또한 문제는 Openshift를 잘 몰라서 그럴 수 있겠지만, 내가 원하는 Domain을 설정 하는 것도 어려운 부분이 있었다. 그래서 우선 별도로 AVI를 구성하여 설치를 진행 후 TAP 설치를 하였습니다. 그리고 설명이 부족한 부분이 많을 수 있는대, 설명을 할 것이 너무 많기 때문에 좀더 Install에 대해서 집중을 해서 글을 작성 하였습니다.</p>
</blockquote>
<h2 id="2-kapp-설치">2. KAPP 설치</h2>
<p>기본적으로 KAPP이 설치가 되어 있지 않기 때문에 KAPP 설치가 필요 합니다. 이유는 TAP이라는 솔루션이 Tanzu라는 명령어를 통해 설치가 되기 때문에 입니다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## package를 설치 할 수 있게 kapp-contoller 설치</span>
</span></span><span class="line"><span class="cl">kubectl apply -f https://github.com/vmware-tanzu/carvel-kapp-controller/releases/latest/download/release.yml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## tanzu에서 secret을 생성 할 수 있게 secretget-controller 설치</span>
</span></span><span class="line"><span class="cl">kubectl apply -f https://github.com/carvel-dev/secretgen-controller/releases/latest/download/release.yml
</span></span></code></pre></td></tr></table>
</div>
</div><p>kapp을 설치를 하게 되면 이제 tanzu package repository 및  secret repository를 등록 할 수 있습니다.</p>
<figure><figcaption>
            <h4>package 및 reository</h4>
        </figcaption>
</figure>

<p>그러면 위와 같이 list를 확인 할 수 있습니다. 위에 controller를 설치를 하지 않으면 에러가 발생 하는 것을 알 수 있습니다. 에러 내용은 아래와 같습니다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kapp contoller를 설치를 안할 경우 발생하는 에러
</span></span><span class="line"><span class="cl"><span class="c1">## Error: failed to check for the availability of &#39;packaging.carvel.dev&#39; API: failed to discover unmatched GroupVersionResources: the server is currently unable to handle the request</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Error: exit status 1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">secret contoller를 설치를 안할 경우 발생하는 에러
</span></span><span class="line"><span class="cl"><span class="c1">## Error: secret plugin can not be used as &#39;secretgen.carvel.dev/v1alpha1&#39; API is not available in the cluster</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Error: exit status 1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3-tanzu-framework-및-pcakage-image-repository-업르도">3. TANZU FRAMEWORK 및 Pcakage Image Repository 업르도</h2>
<p>TANZU FRAMEWORK다운로드는 Tanzu Net에서 다운로드를 받을 수 있다. 
TANZU APPLICATION PLATFORM 설치는 1.4.0으로 진행</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir /var/tmp/tanzu-utils/framework/tap/1.4.0
</span></span><span class="line"><span class="cl">tar xvf /var/tmp/tanzu-utils/framework/tap/1.4.0/tanzu-framework-linux-amd64-v0.25.4.1.tar -C /var/tmp/tanzu-utils/framework/tap/1.4.0
</span></span><span class="line"><span class="cl">tanzu plugin install -l  /var/tmp/tanzu-utils/framework/tap/1.4.0/cli/ all
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 이미지를 받기 위해 tanzu net에 로그인 한다.</span>
</span></span><span class="line"><span class="cl">docker login registry.tanzu.vmware.com -u <span class="o">{</span>tanzuusername<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 이후에 내부 또는 gcr 등등 repository에 로그인 한다. 테스트는 내부 Harbor를 사용한다.</span>
</span></span><span class="line"><span class="cl">docker login infra-harbor.huntedhappy.kro.kr -u admin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## TAP Package 내부 Harbor에 업로드</span>
</span></span><span class="line"><span class="cl">imgpkg copy -b registry.tanzu.vmware.com/tanzu-application-platform/tap-packages:1.4.0 --to-repo infra-harbor.huntedhappy.kro.kr/tap-packages/1.4.0
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="4-tap-package-등록">4. TAP Package 등록</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## namespace 생성</span>
</span></span><span class="line"><span class="cl">kubectl create ns tap-install 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Harbor Secret 사용할 경우</span>
</span></span><span class="line"><span class="cl">kubectl create secret docker-registry registry-credentials --docker-server<span class="o">=</span>infra-harbor.huntedhappy.kro.kr --docker-username<span class="o">=</span>admin --docker-password<span class="o">=</span><span class="si">${</span><span class="nv">INSTALL_REGISTRY_PASSWORD</span><span class="si">}</span> -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## package repository 추가</span>
</span></span><span class="line"><span class="cl">tanzu package repository add tanzu-tap-repository <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --url harbor-infra.huntedhappy.kro.kr/tap-packages/1.4.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --namespace tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## TBS 설치</span>
</span></span><span class="line"><span class="cl">imgpkg copy -b registry.tanzu.vmware.com/tanzu-application-platform/full-tbs-deps-package-repo:1.9.0 --to-tar<span class="o">=</span>tbs-full-deps-1.9.0.tar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## TBS Harobr업로드</span>
</span></span><span class="line"><span class="cl">imgpkg copy --tar tbs-full-deps-1.9.0.tar --to-repo harbor-infra.huntedhappy.kro.kr/tap/tbs-full-deps/1.9.0 --include-non-distributable-layers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## TBS Repository 등록</span>
</span></span><span class="line"><span class="cl">tanzu package repository add tbs-full-deps-repository <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --url infra-harbor.huntedhappy.kro.kr/tap/tbs-full-deps/1.9.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --namespace tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="5-설치">5. 설치</h2>
<p>TAP같은 경우 멀티 클러스터를 지원 하지만, 테스트는 full 기반으로 테스트를 진행 하였습니다.</p>
<p>설치는 ootb_supply_chain_testing_scanning 로 테스트를 진행 했지만. 좀 복잡 할 수 있기 때문에
여기에는 ootb_supply_chain_basic으로 기술 합니다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vi tap-full-vaules.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">profile: full
</span></span><span class="line"><span class="cl">ceip_policy_disclosed: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">buildservice:
</span></span><span class="line"><span class="cl">  kp_default_repository: <span class="s2">&#34;infra-harbor.huntedhappy.kro.kr/tap/tap-packages&#34;</span>
</span></span><span class="line"><span class="cl">  kp_default_repository_secret:
</span></span><span class="line"><span class="cl">    name: <span class="s2">&#34;registry-credentials&#34;</span>
</span></span><span class="line"><span class="cl">    namespace: <span class="s2">&#34;tap-install&#34;</span>
</span></span><span class="line"><span class="cl">  exclude_dependencies: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">springboot_conventions:
</span></span><span class="line"><span class="cl">  autoConfigureActuators: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">policy:
</span></span><span class="line"><span class="cl">  tuf_enable: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">accelerator:
</span></span><span class="line"><span class="cl">  domain: huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">  ingress:
</span></span><span class="line"><span class="cl">    include: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">    enable_tls: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  tls:
</span></span><span class="line"><span class="cl">    secret_name: share-secret
</span></span><span class="line"><span class="cl">    namespace: tap-install
</span></span><span class="line"><span class="cl">  server:
</span></span><span class="line"><span class="cl">    service_type: <span class="s2">&#34;ClusterIP&#34;</span>
</span></span><span class="line"><span class="cl">    watched_namespace: <span class="s2">&#34;accelerator-system&#34;</span>
</span></span><span class="line"><span class="cl">  samples:
</span></span><span class="line"><span class="cl">    include: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shared:
</span></span><span class="line"><span class="cl">  kubernetes_distribution: <span class="s2">&#34;openshift&#34;</span> <span class="c1"># To be passed only for OpenShift. Defaults to &#34;&#34;.</span>
</span></span><span class="line"><span class="cl">  ingress_issuer: default-ca-issuer
</span></span><span class="line"><span class="cl">  image_registry:
</span></span><span class="line"><span class="cl">    secret:
</span></span><span class="line"><span class="cl">      name: <span class="s2">&#34;registry-credentials&#34;</span>
</span></span><span class="line"><span class="cl">      namespace: <span class="s2">&#34;tap-install&#34;</span>
</span></span><span class="line"><span class="cl">  ingress_domain: <span class="s2">&#34;huntedhappy.kro.kr&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  ca_cert_data: |</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">appliveview:
</span></span><span class="line"><span class="cl">  ingressEnabled: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  sslDisabled: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">  tls:
</span></span><span class="line"><span class="cl">    namespace: tap-install
</span></span><span class="line"><span class="cl">    secretName: share-secret
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">appliveview_connector:
</span></span><span class="line"><span class="cl">  backend:
</span></span><span class="line"><span class="cl">    sslDisabled: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">    host: appliveview.huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cnrs:
</span></span><span class="line"><span class="cl">  domain_name: huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">  domain_template: <span class="s2">&#34;{{.Name}}.{{.Domain}}&#34;</span>
</span></span><span class="line"><span class="cl">  default_tls_secret: tap-install/share-secret
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">scanning:
</span></span><span class="line"><span class="cl">  metadataStore:
</span></span><span class="line"><span class="cl">    url: <span class="s2">&#34;&#34;</span> <span class="c1"># Disable embedded integration since it&#39;s deprecated</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">metadata_store:
</span></span><span class="line"><span class="cl">  ns_for_export_app_cert: <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">  ingress_domain: huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">  app_service_type: ClusterIP
</span></span><span class="line"><span class="cl">  ingress_enabled: <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  targetImagePullSecret: <span class="s2">&#34;registry-credentials&#34;</span>
</span></span><span class="line"><span class="cl">  tls:
</span></span><span class="line"><span class="cl">    secretName: share-secret
</span></span><span class="line"><span class="cl">    namespace: tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">supply_chain: basic
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ootb_supply_chain_basic:
</span></span><span class="line"><span class="cl">  registry:
</span></span><span class="line"><span class="cl">    server: <span class="s2">&#34;infra-harbor.huntedhappy.kro.kr&#34;</span>
</span></span><span class="line"><span class="cl">    repository: <span class="s2">&#34;app/supply_chain&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">grype:
</span></span><span class="line"><span class="cl">  namespace: <span class="s2">&#34;tap-install&#34;</span> <span class="c1"># (optional) Defaults to default namespace.</span>
</span></span><span class="line"><span class="cl">  targetImagePullSecret: <span class="s2">&#34;registry-credentials&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tap_gui:
</span></span><span class="line"><span class="cl">  service_type: ClusterIP
</span></span><span class="line"><span class="cl">  ingressEnabled: <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  ingressDomain: <span class="s2">&#34;huntedhappy.kro.kr&#34;</span>
</span></span><span class="line"><span class="cl">  tls:
</span></span><span class="line"><span class="cl">    namespace: tap-install
</span></span><span class="line"><span class="cl">    secretName: share-secret
</span></span><span class="line"><span class="cl">  app_config:
</span></span><span class="line"><span class="cl">    organization:
</span></span><span class="line"><span class="cl">      name: <span class="s1">&#39;huntedhappy&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    app:
</span></span><span class="line"><span class="cl">      title: <span class="s1">&#39;huntedhappy TAP&#39;</span>
</span></span><span class="line"><span class="cl">      baseUrl: https://tap-gui.huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">      support:
</span></span><span class="line"><span class="cl">        url: https://tanzu.vmware.com/support
</span></span><span class="line"><span class="cl">        items:
</span></span><span class="line"><span class="cl">          - title: Contact Support
</span></span><span class="line"><span class="cl">            icon: email
</span></span><span class="line"><span class="cl">            links:
</span></span><span class="line"><span class="cl">              - url: https://tanzu.vmware.com/support
</span></span><span class="line"><span class="cl">                title: Tanzu Support Page
</span></span><span class="line"><span class="cl">          - title: Documentation
</span></span><span class="line"><span class="cl">            icon: doc
</span></span><span class="line"><span class="cl">            links:
</span></span><span class="line"><span class="cl">              - url: https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/index.html
</span></span><span class="line"><span class="cl">                title: Tanzu Application Platform Documentation
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    backend:
</span></span><span class="line"><span class="cl">      baseUrl: https://tap-gui.huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">      cors:
</span></span><span class="line"><span class="cl">        origin: https://tap-gui.huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">contour:
</span></span><span class="line"><span class="cl">  certificates.duration: 87600h
</span></span><span class="line"><span class="cl">  certificates.renewBefore: 360h
</span></span><span class="line"><span class="cl">  envoy:
</span></span><span class="line"><span class="cl">    service:
</span></span><span class="line"><span class="cl">      type: LoadBalancer
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">excluded_packages:
</span></span><span class="line"><span class="cl">- policy.apps.tanzu.vmware.com
</span></span><span class="line"><span class="cl">- learningcenter.tanzu.vmware.com
</span></span><span class="line"><span class="cl">- workshops.learningcenter.tanzu.vmware.com
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## rback 설정</span>
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF &gt; tap-gui-viewer-service-account-rbac.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Namespace
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">automountServiceAccountToken: false
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Secret
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">  annotations:
</span></span></span><span class="line"><span class="cl"><span class="s">    kubernetes.io/service-account.name: tap-gui-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">type: kubernetes.io/service-account-token
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-read-k8s
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">- kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: k8s-reader
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: k8s-reader
</span></span></span><span class="line"><span class="cl"><span class="s">rules:
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;pods&#39;, &#39;pods/log&#39;, &#39;services&#39;, &#39;configmaps&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;apps&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;deployments&#39;, &#39;replicasets&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;autoscaling&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;horizontalpodautoscalers&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;networking.k8s.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;ingresses&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;networking.internal.knative.dev&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;serverlessservices&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [ &#39;autoscaling.internal.knative.dev&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [ &#39;podautoscalers&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [ &#39;get&#39;, &#39;watch&#39;, &#39;list&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;serving.knative.dev&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - configurations
</span></span></span><span class="line"><span class="cl"><span class="s">  - revisions
</span></span></span><span class="line"><span class="cl"><span class="s">  - routes
</span></span></span><span class="line"><span class="cl"><span class="s">  - services
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;carto.run&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterconfigtemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterdeliveries
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterdeploymenttemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterimagetemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterruntemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clustersourcetemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clustersupplychains
</span></span></span><span class="line"><span class="cl"><span class="s">  - clustertemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - deliverables
</span></span></span><span class="line"><span class="cl"><span class="s">  - runnables
</span></span></span><span class="line"><span class="cl"><span class="s">  - workloads
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;source.toolkit.fluxcd.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - gitrepositories
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;source.apps.tanzu.vmware.com&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - imagerepositories
</span></span></span><span class="line"><span class="cl"><span class="s">  - mavenartifacts
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;conventions.carto.run&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - podintents
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;kpack.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - images
</span></span></span><span class="line"><span class="cl"><span class="s">  - builds
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;scanning.apps.tanzu.vmware.com&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - sourcescans
</span></span></span><span class="line"><span class="cl"><span class="s">  - imagescans
</span></span></span><span class="line"><span class="cl"><span class="s">  - scanpolicies
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;tekton.dev&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - taskruns
</span></span></span><span class="line"><span class="cl"><span class="s">  - pipelineruns
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;kappctrl.k14s.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - apps
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## rolebding 설정</span>
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF &gt; rolebinding.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default-permit-deliverable
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: deliverable
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default-permit-workload
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: workload
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: dev-permit-app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: Group
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#34;namespace-developers&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: namespace-dev-permit-app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: app-viewer-cluster-access
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: Group
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#34;namespace-developers&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl patch sa default -n tap-install --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;add&#34;,&#34;path&#34;:&#34;/secrets&#34;,&#34;value&#34;:[&#34;name&#34;:&#34;registry-credentials&#34;]}]&#39;</span>
</span></span><span class="line"><span class="cl">kubectl patch sa default -n tap-install --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;add&#34;,&#34;path&#34;:&#34;/imagePullSecrets&#34;,&#34;value&#34;:[&#34;name&#34;:&#34;registry-credentials&#34;]}]&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl apply -f rolebinding.yaml -n tap-install 
</span></span><span class="line"><span class="cl">kubectl apply -f tap-gui-viewer-service-account-rbac.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## TANZU PACKAGE 1.4.0 설치</span>
</span></span><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v 1.4.0 -f tap-full-vaules.yaml -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## TBS 설치</span>
</span></span><span class="line"><span class="cl">tanzu package install full-tbs-deps -p full-tbs-deps.tanzu.vmware.com -v 1.9.0 -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="6-설치-완료">6. 설치 완료</h2>
<figure><figcaption>
            <h4>설치 완료#1</h4>
        </figcaption>
</figure>

<p>Sample App Test
<figure><figcaption>
            <h4>설치 완료#2</h4>
        </figcaption>
</figure>
</p>
<p>Sample App Test를 하게 될 경우 아래와 같은 문구가 나오는대 왜 나오는지는 아직 파악 하지 못하였습니다. 하지만 SAMPLE APP 배포는 잘 동작 하는 것을 확인 할 수 있습니다.</p>
<p>I0129 14:54:36.521207 2768383 request.go:682] Waited for 1.007213447s due to client-side throttling, not priority and fairness, request: GET:https://api.openshift.huntedhappy.kro.kr:6443/apis/console.openshift.io/v1alpha1?timeout=32s</p>
<p><figure><figcaption>
            <h4>설치 완료#2</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TAP GUI 화면#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TAP GUI 화면#2</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TAP GUI 화면#2</h4>
        </figcaption>
</figure>
</p>
<p>설치가 완료 되면 TAP의 대해서는 Visual Sutudio Code, IntelliJ 환경에서도 잘 동작하는 것을 확인 할 수 있습니다.</p>
]]></description>
</item><item>
    <title>The Documentation Harbor</title>
    <link>https://huntedhappy.github.io/ko/harbor/</link>
    <pubDate>Sat, 07 Jan 2023 19:00:14 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/harbor/</guid>
    <description><![CDATA[<h2 id="harbor에-vm-disk가-부족-하게-되면-사이즈를-늘려보자">Harbor에 VM Disk가 부족 하게 되면 사이즈를 늘려보자</h2>
<h2 id="1-harbor-vm-disk-증설">1. Harbor VM DISK 증설</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">df -h
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fdisk -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 아래와 같이 에러가 나온다면</span>
</span></span><span class="line"><span class="cl">&gt;&gt; GPT PMBR size mismatch 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## parted로 fix를 해보자</span>
</span></span><span class="line"><span class="cl">parted /dev/sda
</span></span><span class="line"><span class="cl">p &gt; f
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>Disk 상태 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Disk 증설</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Disk 증설 후</h4>
        </figcaption>
</figure>
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## 그리고 온라인 상태에서 디스크가 보이지 않은 경우는 아래와 같이 하자.</span>
</span></span><span class="line"><span class="cl">ls /sys/class/scsi_host
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> line in <span class="k">$(</span>ls /sys/class/scsi_host<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl"> <span class="nb">echo</span> <span class="s2">&#34;- - -&#34;</span> &gt; /sys/class/scsi_host/<span class="nv">$line</span>/scan
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ls -lat /dev/sd*
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>Disk 증설 후 SCAN</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>디스크 증설 확인#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>디스크 증설 확인#2</h4>
        </figcaption>
</figure>
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pvs
</span></span><span class="line"><span class="cl">lvs
</span></span><span class="line"><span class="cl">pvcreate /dev/sdb
</span></span><span class="line"><span class="cl">vgextend ubuntu-vg /dev/sdb
</span></span><span class="line"><span class="cl">lvextend /dev/mapper/ubuntu--vg-ubuntu--lv /dev/sdb
</span></span><span class="line"><span class="cl">resize2fs -p /dev/mapper/ubuntu--vg-ubuntu--lv
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>Disk 확인 및 증설#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Disk 확인 및 증설#2</h4>
        </figcaption>
</figure>
</p>
<h2 id="2-tanzu에-pacakge로-설치-한-harbor-사이즈-증설">2. TANZU에 Pacakge로 설치 한 Harbor 사이즈 증설</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl -n tanzu-system-registry get pvc --selector<span class="o">=</span><span class="nv">component</span><span class="o">=</span>registry --show-labels
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 아래 storage 용량을 설정한다.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF &gt; harbor-registry-pvc.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: PersistentVolumeClaim
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  finalizers:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kubernetes.io/pvc-protection
</span></span></span><span class="line"><span class="cl"><span class="s">  labels:
</span></span></span><span class="line"><span class="cl"><span class="s">    app: harbor
</span></span></span><span class="line"><span class="cl"><span class="s">    component: registry
</span></span></span><span class="line"><span class="cl"><span class="s">    kapp.k14s.io/app: &#34;1610567506920108209&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    kapp.k14s.io/association: v1.034269eb21810ed9131cc41a27c729d4
</span></span></span><span class="line"><span class="cl"><span class="s">  name: harbor-registry-200gb
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tanzu-system-registry
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  accessModes:
</span></span></span><span class="line"><span class="cl"><span class="s">  - ReadWriteOnce
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">    requests:
</span></span></span><span class="line"><span class="cl"><span class="s">      storage: 200Gi
</span></span></span><span class="line"><span class="cl"><span class="s">  storageClassName: default
</span></span></span><span class="line"><span class="cl"><span class="s">  volumeMode: Filesystem
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 그리고 pvc 생성 후 pod를 삭제 하기 위해 0으로 변경</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry apply -f harbor-registry-pvc.yaml
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry scale deployment harbor-registry --replicas<span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">watch -n <span class="m">5</span> kubectl get pod -n tanzu-system-registry
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## volumemount 및 volumes을 설정 해준다.</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry edit deployment harbor-registry
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 아래 항목을 찾는다.</span>
</span></span><span class="line"><span class="cl">      volumeMounts:
</span></span><span class="line"><span class="cl">        - mountPath: /storage
</span></span><span class="line"><span class="cl">          name: registry-data
</span></span><span class="line"><span class="cl">        - mountPath: /etc/registry/passwd
</span></span><span class="line"><span class="cl">          name: registry-htpasswd
</span></span><span class="line"><span class="cl">          subPath: passwd
</span></span><span class="line"><span class="cl">        - mountPath: /etc/registry/config.yml
</span></span><span class="line"><span class="cl">          name: registry-config
</span></span><span class="line"><span class="cl">          subPath: config.yml
</span></span><span class="line"><span class="cl">        - mountPath: /etc/harbor/ssl/registry
</span></span><span class="line"><span class="cl">          name: registry-internal-certs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 마지막줄에 아래 내용을 추가 한다.</span>
</span></span><span class="line"><span class="cl">        - mountPath: /storage2
</span></span><span class="line"><span class="cl">          name: registry-data2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 아래 항목을 찾는다.</span>
</span></span><span class="line"><span class="cl">    volumes:
</span></span><span class="line"><span class="cl">      - name: registry-htpasswd
</span></span><span class="line"><span class="cl">        secret:
</span></span><span class="line"><span class="cl">          defaultMode: <span class="m">420</span>
</span></span><span class="line"><span class="cl">          items:
</span></span><span class="line"><span class="cl">          - key: REGISTRY_HTPASSWD
</span></span><span class="line"><span class="cl">            path: passwd
</span></span><span class="line"><span class="cl">          secretName: harbor-registry-htpasswd
</span></span><span class="line"><span class="cl">      - configMap:
</span></span><span class="line"><span class="cl">          defaultMode: <span class="m">420</span>
</span></span><span class="line"><span class="cl">          name: harbor-registry-ver-6
</span></span><span class="line"><span class="cl">        name: registry-config
</span></span><span class="line"><span class="cl">      - name: registry-internal-certs
</span></span><span class="line"><span class="cl">        secret:
</span></span><span class="line"><span class="cl">          defaultMode: <span class="m">420</span>
</span></span><span class="line"><span class="cl">          secretName: harbor-registry-internal-tls
</span></span><span class="line"><span class="cl"><span class="c1">## 마지막줄에 아래 내용을 추가 한다.</span>
</span></span><span class="line"><span class="cl">      - name: registry-data2
</span></span><span class="line"><span class="cl">        persistentVolumeClaim:
</span></span><span class="line"><span class="cl">          claimName: harbor-registry-200gb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## pod를 생성 한다.</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry scale deployments.apps harbor-registry --replicas<span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">watch -n <span class="m">5</span> kubectl get pod -n tanzu-system-registry
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## pod에 접속 하여 storage repository를 확인 한 후 신규로 연결된 storage2에 Copy.</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry get po --selector<span class="o">=</span><span class="nv">component</span><span class="o">=</span>registry
</span></span><span class="line"><span class="cl"><span class="nv">registry</span><span class="o">=</span><span class="k">$(</span>kubectl -n tanzu-system-registry get po --selector<span class="o">=</span><span class="nv">component</span><span class="o">=</span>registry <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span> <span class="p">|</span> grep  harbor<span class="k">)</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry <span class="nb">exec</span> -ti <span class="nv">$registry</span> -- /bin/bash
</span></span><span class="line"><span class="cl">df -h /storage
</span></span><span class="line"><span class="cl">ls storage/docker/registry/v2/repositories/library/
</span></span><span class="line"><span class="cl">cp -rfp /storage/* /storage2/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## pod 삭제</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry scale deployment harbor-registry --replicas<span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">watch -n <span class="m">5</span> kubectl get pod -n tanzu-system-registry
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 위에 설정한 volumemount 및 volumes 삭제</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry edit deployment harbor-registry
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 새로 생성 한 pvc 확인</span>
</span></span><span class="line"><span class="cl"><span class="nv">newpvc</span><span class="o">=</span><span class="k">$(</span>kubectl get pv <span class="p">|</span>grep 200gb <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">kubectl patch pv <span class="nv">$newpvc</span> -p <span class="s1">&#39;{&#34;spec&#34;:{&#34;persistentVolumeReclaimPolicy&#34;:&#34;Retain&#34;}}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get pv <span class="p">|</span> grep harbor-registry
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry delete pvc --selector<span class="o">=</span><span class="nv">component</span><span class="o">=</span>registry
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## pv에서 아래 내용 삭제</span>
</span></span><span class="line"><span class="cl"><span class="nv">newpv</span><span class="o">=</span><span class="k">$(</span>kubectl get pv <span class="p">|</span> grep 200gb <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">kubectl edit pv <span class="nv">$newpv</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 아래 항목을 찾은 후 claimRef 내용을 삭제 해준다.</span>
</span></span><span class="line"><span class="cl">  claimRef:
</span></span><span class="line"><span class="cl">    apiVersion: v1
</span></span><span class="line"><span class="cl">    kind: PersistentVolumeClaim
</span></span><span class="line"><span class="cl">    name: harbor-registry-100gb
</span></span><span class="line"><span class="cl">    namespace: tanzu-system-registry
</span></span><span class="line"><span class="cl">    resourceVersion: <span class="s2">&#34;5894668&#34;</span>
</span></span><span class="line"><span class="cl">    uid: 326b24df-dd6f-4679-af84-6530013aed22
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pvc-생성">pvc 생성</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF &gt; harbor-registry-200gb.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: PersistentVolumeClaim
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  finalizers:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kubernetes.io/pvc-protection
</span></span></span><span class="line"><span class="cl"><span class="s">  labels:
</span></span></span><span class="line"><span class="cl"><span class="s">    app: harbor
</span></span></span><span class="line"><span class="cl"><span class="s">    component: registry
</span></span></span><span class="line"><span class="cl"><span class="s">    kapp.k14s.io/app: &#34;1610567506920108209&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    kapp.k14s.io/association: v1.034269eb21810ed9131cc41a27c729d4
</span></span></span><span class="line"><span class="cl"><span class="s">  name: harbor-registry
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tanzu-system-registry
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  accessModes:
</span></span></span><span class="line"><span class="cl"><span class="s">  - ReadWriteOnce
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">    requests:
</span></span></span><span class="line"><span class="cl"><span class="s">      storage: 200Gi
</span></span></span><span class="line"><span class="cl"><span class="s">  storageClassName: default
</span></span></span><span class="line"><span class="cl"><span class="s">  volumeName: $newpvc
</span></span></span><span class="line"><span class="cl"><span class="s">  volumeMode: Filesystem
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## pvc 생성</span>
</span></span><span class="line"><span class="cl">kubectl apply -f harbor-registry-200gb.yaml -n tanzu-system-registry
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## pod 생성</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry scale deployment harbor-registry --replicas<span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">watch -n <span class="m">5</span> kubectl get pod -n tanzu-system-registry
</span></span><span class="line"><span class="cl"><span class="c1">## Delete로 변경</span>
</span></span><span class="line"><span class="cl">kubectl patch pv <span class="nv">$newpvc</span> -p <span class="s1">&#39;{&#34;spec&#34;:{&#34;persistentVolumeReclaimPolicy&#34;:&#34;Delete&#34;}}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 확인</span>
</span></span><span class="line"><span class="cl"><span class="nv">registry</span><span class="o">=</span><span class="k">$(</span>kubectl -n tanzu-system-registry get po --selector<span class="o">=</span><span class="nv">component</span><span class="o">=</span>registry <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span> <span class="p">|</span> grep  harbor<span class="k">)</span>
</span></span><span class="line"><span class="cl">kubectl -n tanzu-system-registry <span class="nb">exec</span> -ti <span class="nv">$registry</span> -- /bin/bash
</span></span><span class="line"><span class="cl">df -h /storage
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>증설 전</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>증설 후 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Docker Image 확인</h4>
        </figcaption>
</figure>
</p>
]]></description>
</item><item>
    <title>The Documentation Tanzu Community Edition with TAP</title>
    <link>https://huntedhappy.github.io/ko/tce/</link>
    <pubDate>Tue, 06 Dec 2022 20:51:50 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/tce/</guid>
    <description><![CDATA[<h2 id="1-tanzu-community-edition">1. TANZU Community Edition?</h2>
<p>Tanzu Community Edition은 무료로 사용 가능한 VMware에서 제공하는 Kubernetes 플랫폼으로 손쉽게 클러스터를 구성 할 수 있는 솔루션이다. 
유료 서비스인 TKG 플랫폼의 모든 기능을 사용 할 수 있지만, 몇가지 제약적인 부분이 있을 수 있다. 가령 하나의 클러스터만 배포를 할 수 있는 단점이 있을 수 있으며 별도로 솔루션의 대한 이슈 및 설치의 대해서 지원을 받지 못한다.</p>
<p>하지만 TKG 솔루션의 대해서 사전에 테스트 환경을 구축 함으로 Kubernetes 플랫폼의 손쉬운 배포 와 VMware에서 제공하는 오픈소스 에코 시스템을 통해 확장의 대해서도 손쉽게 구현을 할 수 있을 것이다.</p>
<p>아래에 제공하는 오픈소스를 효율적으로 구성을 할 수 있다.
<figure><figcaption>
            <h4>Eco System</h4>
        </figcaption>
</figure>
</p>
<h2 id="2-tanzu-community-edition-구성">2. TANZU Community Edition 구성</h2>
<p><a href="https://docs.docker.com/desktop/install/windows-install/" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> Docker 설치 링크</a>
<a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> KIND 설치 링크</a></p>
<p>KIND는 Kubernetes 클러스터는 싱글 노드에서 구축을 할 수 있으며, 비슷한 솔루션으로는 MINIKUBE, K3S등이 있다.
구성환경은 윈도우 10, i7-4770 CPU 16GB 이며 아래는 gitops를 사용하지 않았으며, 마찬가지로 gitops로 구성하여 git에 소스를 머지 할 수도 있지만 여기서는 해당 기능의 대해서는 넣지 않았다.</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>KIND Install<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># MAC OS</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for Intel Macs</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> <span class="k">$(</span>uname -m<span class="k">)</span> <span class="o">=</span> x86_64 <span class="o">]&amp;&amp;</span> curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.17.0/kind-darwin-amd64
</span></span><span class="line"><span class="cl"><span class="c1"># for M1 / ARM Macs</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> <span class="k">$(</span>uname -m<span class="k">)</span> <span class="o">=</span> arm64 <span class="o">]</span> <span class="o">&amp;&amp;</span> curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.17.0/kind-darwin-arm64
</span></span><span class="line"><span class="cl">chmod +x ./kind
</span></span><span class="line"><span class="cl">mv ./kind /some-dir-in-your-PATH/kind
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># WINDOWS</span>
</span></span><span class="line"><span class="cl"><span class="n">curl</span><span class="p">.</span><span class="n">exe</span> <span class="n">-Lo</span> <span class="nb">kind-windows</span><span class="n">-amd64</span><span class="p">.</span><span class="n">exe</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">kind</span><span class="p">.</span><span class="n">sigs</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">dl</span><span class="p">/</span><span class="n">v0</span><span class="p">.</span><span class="n">17</span><span class="p">.</span><span class="n">0</span><span class="p">/</span><span class="nb">kind-windows</span><span class="n">-amd64</span>
</span></span><span class="line"><span class="cl"><span class="nb">Move-Item</span> <span class="p">.\</span><span class="nb">kind-windows</span><span class="n">-amd64</span><span class="p">.</span><span class="n">exe</span> <span class="n">c:</span><span class="p">\</span><span class="nb">some-dir</span><span class="n">-in-your-PATH</span><span class="p">\</span><span class="n">kind</span><span class="p">.</span><span class="n">exe</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># Linux</span>
</span></span><span class="line"><span class="cl">curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.17.0/kind-linux-amd64
</span></span><span class="line"><span class="cl">chmod +x ./kind
</span></span><span class="line"><span class="cl">sudo mv ./kind /usr/local/bin/kind
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>KIND Cluster 생성<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>kind-expose-port.yaml 파일 생성 후 아래 내용 추가</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kind.x-k8s.io/v1alpha4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">nodes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l">control-plane</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">extraPortMappings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">31443</span><span class="w"> </span><span class="c"># expose port 31443 of the node to port 80 on the host for use later by Contour ingress (envoy)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nt">hostPort</span><span class="p">:</span><span class="w"> </span><span class="m">443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">31080</span><span class="w"> </span><span class="c"># expose port 31080 of the node to port 80 on the host for use later by Contour ingress (envoy)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nt">hostPort</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># 실행</span>
</span></span><span class="line"><span class="cl"><span class="n">kind</span> <span class="n">create</span> <span class="n">cluster</span> <span class="p">-</span><span class="n">-config</span> <span class="nb">kind-expose</span><span class="n">-port</span><span class="p">.</span><span class="n">yaml</span> <span class="p">-</span><span class="n">-image</span> <span class="n">kindest</span><span class="p">/</span><span class="n">node</span><span class="err">:</span><span class="n">v1</span><span class="p">.</span><span class="n">23</span><span class="p">.</span><span class="n">12</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<figure><figcaption>
            <h4>Kind Cluster 확인</h4>
        </figcaption>
</figure>

<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Pivnet 다운로드 <i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">curl</span><span class="p">.</span><span class="n">exe</span> <span class="n">-Lo</span> <span class="nb">pivnet-windows</span><span class="n">-amd64</span><span class="p">-</span><span class="n">3</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">exe</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="nb">pivotal-cf</span><span class="p">/</span><span class="nb">pivnet-cli</span><span class="p">/</span><span class="n">releases</span><span class="p">/</span><span class="n">download</span><span class="p">/</span><span class="n">v3</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">/</span><span class="nb">pivnet-windows</span><span class="n">-amd64</span><span class="p">-</span><span class="n">3</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span>
</span></span><span class="line"><span class="cl"><span class="nb">Move-Item</span> <span class="p">.\</span><span class="nb">pivnet-windows</span><span class="n">-amd64</span><span class="p">-</span><span class="n">3</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">exe</span> <span class="n">c:</span><span class="p">\</span><span class="n">tmc</span><span class="p">\</span><span class="n">pivnet</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pivnet</span> <span class="n">login</span> <span class="p">-</span><span class="n">-api-token</span><span class="p">=&lt;</span><span class="n">API</span> <span class="n">Token</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">## TANZU NET에서 EULA Accept 필요</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Tanzu CLI Install<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># tanzu application framework download</span>
</span></span><span class="line"><span class="cl">pivnet dlpf -p tanzu-application-platform -r 1.3.2 -g *framework*
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># Linux</span>
</span></span><span class="line"><span class="cl">tar xvf tanzu-framework-*-amd64-*.tar
</span></span><span class="line"><span class="cl">install cli/core/v0.25.0/tanzu-core-*_amd64 /usr/local/bin/tanzu
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TANZU_CLI_NO_INIT</span><span class="o">=</span><span class="nb">true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Windows</span>
</span></span><span class="line"><span class="cl"><span class="nb">Expand-Archive</span> <span class="n">-Force</span> <span class="nb">tanzu-framework</span><span class="p">-*</span><span class="n">-amd64</span><span class="p">-*.</span><span class="n">zip</span> <span class="n">c:</span><span class="p">\</span><span class="n">tmc</span>
</span></span><span class="line"><span class="cl"><span class="nb">Copy-Item</span> <span class="n">C:</span><span class="p">\</span><span class="n">tmc</span><span class="p">\</span><span class="n">cli</span><span class="p">\</span><span class="n">core</span><span class="p">\</span><span class="n">v0</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">0</span><span class="p">/</span><span class="nb">tanzu-core</span><span class="p">-*</span><span class="n">_amd64</span><span class="p">*</span> <span class="n">c:</span><span class="p">\</span><span class="n">tmc</span><span class="p">\</span><span class="n">tanzu</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Version 확인</span>
</span></span><span class="line"><span class="cl"><span class="n">tanzu</span> <span class="n">version</span>
</span></span><span class="line"><span class="cl"><span class="p">-----------------</span>
</span></span><span class="line"><span class="cl"><span class="n">version</span><span class="err">:</span> <span class="n">v0</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">0</span>
</span></span><span class="line"><span class="cl"><span class="n">buildDate</span><span class="err">:</span> <span class="n">2022</span><span class="p">-</span><span class="n">08</span><span class="p">-</span><span class="n">25</span>
</span></span><span class="line"><span class="cl"><span class="n">sha</span><span class="err">:</span> <span class="n">6288c751-dirty</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Plugin 설치</span>
</span></span><span class="line"><span class="cl"><span class="n">tanzu</span> <span class="n">plugin</span> <span class="n">install</span> <span class="p">-</span><span class="n">-local</span> <span class="n">c:</span><span class="p">\</span><span class="n">tmc</span><span class="p">\</span><span class="nb">cli </span><span class="n">all</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Cluster Essentials Install<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># tanzu-cluster-essentials download</span>
</span></span><span class="line"><span class="cl">pivnet dlpf -p tanzu-cluster-essentials -r 1.3.0 -g *essentials*
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">tar</span> <span class="n">xzvf</span> <span class="nb">tanzu-cluster</span><span class="n">-essentials-windows-amd64</span><span class="p">-</span><span class="n">1</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">tgz</span> <span class="n">-C</span> <span class="n">c:</span><span class="p">\</span><span class="n">tmc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$Env:TANZUNET_USERNAME</span><span class="p">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Env:TANZUNET_PASSWORD</span><span class="p">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Env:INSTALL_BUNDLE</span><span class="p">=</span><span class="s1">&#39;registry.tanzu.vmware.com/tanzu-cluster-essentials/cluster-essentials-bundle:1.3.0&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Env:INSTALL_REGISTRY_HOSTNAME</span><span class="p">=</span><span class="s1">&#39;registry.tanzu.vmware.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Env:INSTALL_REGISTRY_USERNAME</span><span class="p">=</span><span class="nv">$Env:TANZUNET_USERNAME</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Env:INSTALL_REGISTRY_PASSWORD</span><span class="p">=</span><span class="nv">$Env:TANZUNET_PASSWORD</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c:</span><span class="p">\</span><span class="n">tmc</span><span class="p">\</span><span class="n">install</span><span class="p">.</span><span class="n">bat</span> <span class="n">-y</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p>만약 원하는 OS만 받고 싶으면 해당 하는 파일이름을 -g {설치하고자 하는 OS 선택}
<figure><figcaption>
            <h4>TKGM Downloads</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>essentials Downloads</h4>
        </figcaption>
</figure>
</p>
<p>구성된 KIND cluster에 TAP iterate를 설치하여 source를 테스트 하고 빠르게 build를 함으로 개발의 민첩성을 제공 할 수 있다.
별도의 클러스터를 구성해서 사용 할 수 있지만, 이렇게 TCE를 구성함으로 인해서 노트북에서도 생성 후 테스트를 할 수 있다.</p>
<figure><figcaption>
            <h4>iterate에 포함된 opensource</h4>
        </figcaption>
</figure>

<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Tanzu Application Install<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create ns tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl create secret docker-registry tap-registry --docker-server<span class="o">=</span>registry.tanzu.vmware.com --docker-username<span class="o">=</span><span class="nv">$Env</span>:TANZUNET_USERNAME --docker-password<span class="o">=</span><span class="nv">$Env</span>:TANZUNET_PASSWORD -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package repository add tanzu-tap-repository --url registry.tanzu.vmware.com/tanzu-application-platform/tap-packages:1.3.2 -n tap-install --wait<span class="o">=</span><span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plugin 확인</span>
</span></span><span class="line"><span class="cl">tanzu package available list --namespace tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GIT 환경변수 등록</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Env</span>:GITHUB_USERNAME<span class="o">=</span>github-name
</span></span><span class="line"><span class="cl"><span class="nv">$Env</span>:GITHUB_TOKEN<span class="o">=</span>api-token
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># tap-values.yaml</span>
</span></span><span class="line"><span class="cl">shared:
</span></span><span class="line"><span class="cl">  ingress_domain: huntedhappy.kro.kr
</span></span><span class="line"><span class="cl">  image_registry:
</span></span><span class="line"><span class="cl">    project_path: ghcr.io/<span class="nv">$Env</span>:GITHUB_USERNAME
</span></span><span class="line"><span class="cl">    username: <span class="nv">$Env</span>:GITHUB_USERNAME
</span></span><span class="line"><span class="cl">    password: <span class="nv">$Env</span>:GITHUB_TOKEN
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">ceip_policy_disclosed: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">profile: iterate
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">supply_chain: basic
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">contour:
</span></span><span class="line"><span class="cl">  contour:
</span></span><span class="line"><span class="cl">    replicas: <span class="m">1</span>
</span></span><span class="line"><span class="cl">  envoy:
</span></span><span class="line"><span class="cl">    service:
</span></span><span class="line"><span class="cl">      type: NodePort
</span></span><span class="line"><span class="cl">      nodePorts:
</span></span><span class="line"><span class="cl">        http: <span class="m">31080</span>
</span></span><span class="line"><span class="cl">        https: <span class="m">31443</span>
</span></span><span class="line"><span class="cl">    hostPorts:
</span></span><span class="line"><span class="cl">      enable: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cnrs:
</span></span><span class="line"><span class="cl">  domain_template: <span class="s2">&#34;{{.Name}}.{{.Domain}}&#34;</span>
</span></span><span class="line"><span class="cl">  provider: <span class="nb">local</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">excluded_packages:
</span></span><span class="line"><span class="cl">- policy.apps.tanzu.vmware.com
</span></span><span class="line"><span class="cl">- image-policy-webhook.signing.apps.tanzu.vmware.com
</span></span><span class="line"><span class="cl">- eventing.tanzu.vmware.com
</span></span><span class="line"><span class="cl">- sso.apps.tanzu.vmware.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># TAP 설치</span>
</span></span><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v 1.3.2 -f tap-values.yaml -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Namespace 생성</span>
</span></span><span class="line"><span class="cl">kubectl get app -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Workload 실행 파일 생성<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># git-repository-credentials 생성</span>
</span></span><span class="line"><span class="cl">kubectl create secret docker-registry git-repository-credentials --docker-server ghcr.io --docker-username <span class="nv">$Env</span>:GITHUB_USERNAME --password <span class="nv">$Env</span>:GITHUB_TOKEN -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># rbac.yaml 생성</span>
</span></span><span class="line"><span class="cl">apiVersion: v1
</span></span><span class="line"><span class="cl">kind: ServiceAccount
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: default
</span></span><span class="line"><span class="cl">secrets:
</span></span><span class="line"><span class="cl">- name: git-registry-credentials
</span></span><span class="line"><span class="cl">imagePullSecrets:
</span></span><span class="line"><span class="cl">- name: git-registry-credentials
</span></span><span class="line"><span class="cl">- name: tap-registry
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">apiVersion: rbac.authorization.k8s.io/v1
</span></span><span class="line"><span class="cl">kind: RoleBinding
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: default-permit-deliverable
</span></span><span class="line"><span class="cl">roleRef:
</span></span><span class="line"><span class="cl">  apiGroup: rbac.authorization.k8s.io
</span></span><span class="line"><span class="cl">  kind: ClusterRole
</span></span><span class="line"><span class="cl">  name: deliverable
</span></span><span class="line"><span class="cl">subjects:
</span></span><span class="line"><span class="cl">  - kind: ServiceAccount
</span></span><span class="line"><span class="cl">    name: default
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">apiVersion: rbac.authorization.k8s.io/v1
</span></span><span class="line"><span class="cl">kind: RoleBinding
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: default-permit-workload
</span></span><span class="line"><span class="cl">roleRef:
</span></span><span class="line"><span class="cl">  apiGroup: rbac.authorization.k8s.io
</span></span><span class="line"><span class="cl">  kind: ClusterRole
</span></span><span class="line"><span class="cl">  name: workload
</span></span><span class="line"><span class="cl">subjects:
</span></span><span class="line"><span class="cl">- kind: ServiceAccount
</span></span><span class="line"><span class="cl">  name: default
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># rbac 실행</span>
</span></span><span class="line"><span class="cl">kubectl apply -f rbac.yaml -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 새 파일 생성</span>
</span></span><span class="line"><span class="cl">tanzu-java-web-app.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 아래 내용 추가</span>
</span></span><span class="line"><span class="cl">apiVersion: carto.run/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workload
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  labels:
</span></span><span class="line"><span class="cl">    apps.tanzu.vmware.com/workload-type: web
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  params:
</span></span><span class="line"><span class="cl">  - name: annotations
</span></span><span class="line"><span class="cl">    value:
</span></span><span class="line"><span class="cl">      autoscaling.knative.dev/minScale: <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  source:
</span></span><span class="line"><span class="cl">    git:
</span></span><span class="line"><span class="cl">      ref:
</span></span><span class="line"><span class="cl">        branch: main
</span></span><span class="line"><span class="cl">      url: https://github.com/sample-accelerators/tanzu-java-web-app
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># workload 실행</span>
</span></span><span class="line"><span class="cl">kubectl apply -f tanzu-java-web-app.yaml -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Workload 확인<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu app workload get tanzu-java-web-app -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get pod, httpproxy -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p><figure><figcaption>
            <h4>Workload 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Workload 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Result</h4>
        </figcaption>
</figure>
</p>
]]></description>
</item><item>
    <title>The Documentation Tanzu &amp; Keycloak</title>
    <link>https://huntedhappy.github.io/ko/tanzu-keycloak/</link>
    <pubDate>Fri, 15 Jul 2022 17:49:37 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/tanzu-keycloak/</guid>
    <description><![CDATA[<h2 id="1-tanzu와-keycloak-연동">1. TANZU와 KEYCLOAK 연동</h2>
<p>TANZU는 기본적으로 LDAPS 또는 OIDC와 연동이 가능합니다. 그 중에 무료 서비스인 KEYCLOAK을 활용하여 TANZU와 KEYCLOAK 연동</p>
<h2 id="2-keycloak-구성">2. KEYCLOAK 구성</h2>
<p><a href="https://www.keycloak.org/downloads" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> KEYCLOAK DOWNLOAD LINK</a></p>
<figure><figcaption>
            <h4>keycloak download</h4>
        </figcaption>
</figure>

<p>KEYCLOAK 설치
인증서는 사설 인증서로 생성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## 압축 해제</span>
</span></span><span class="line"><span class="cl">tar zxvf keycloak-18.0.2.tar.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> keycloak-18.0.2
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">KEYCLOAK_ADMIN</span><span class="o">=</span>admin
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">KEYCLOAK_ADMIN_PASSWORD</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bin/kc.sh start-dev --https-certificate-file <span class="o">{</span>인증서<span class="o">}</span> --https-certificate-key-file <span class="o">{</span>인증서 KEY<span class="o">}</span> --https-port <span class="m">8443</span> --hostname <span class="o">{</span>hostname<span class="o">}</span> <span class="p">&amp;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>reaml 생성
<figure><figcaption>
            <h4>realm 생성</h4>
        </figcaption>
</figure>
</p>
<p>필요한 Client Scopes
<figure><figcaption>
            <h4>Client Scopes</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Client Scopes</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Client Scopes</h4>
        </figcaption>
</figure>
</p>
<p>Clients 생성
<figure><figcaption>
            <h4>Clients 생성</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Clients 생성</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Clients 생성</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Clients 생성</h4>
        </figcaption>
</figure>
</p>
<figure><figcaption>
            <h4>Role</h4>
        </figcaption>
</figure>

<p>생성한 Client Scopes를 Default Client Scopes에 이동
<figure><figcaption>
            <h4>Scopes 선택</h4>
        </figcaption>
</figure>
</p>
<p><figure><figcaption>
            <h4>Groups 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Groups 설정</h4>
        </figcaption>
</figure>
</p>
<p>Roles
<figure><figcaption>
            <h4>Roles 설정</h4>
        </figcaption>
</figure>
</p>
<p>Groups
<figure><figcaption>
            <h4>Groups 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Groups 설정</h4>
        </figcaption>
</figure>
</p>
<p>Users
<figure><figcaption>
            <h4>Users 생성</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Users 생성</h4>
        </figcaption>
</figure>
</p>
<p>User Password 설정
<figure><figcaption>
            <h4>User Password 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>User Password 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Group에 할당</h4>
        </figcaption>
</figure>
</p>
<h2 id="3-tanzu-구성">3. TANZU 구성</h2>
<p>사설 인증서로 구성을 했기 때문에 당연히 worker Node에도 신뢰된 인증서로 들어가 있어야 하며, 처음 구성시 CA를 넣는 부분이 없기 때문에 배포가 완료 후 CA를 넣어야 함</p>
<p>OIDC 추출</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## management cluster 변경</span>
</span></span><span class="line"><span class="cl"><span class="nv">cluster</span><span class="o">=</span>tkgm02
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$IDENTITY_MANAGEMENT_TYPE</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">_TKG_CLUSTER_FORCE_ROLE</span><span class="o">=</span><span class="s2">&#34;management&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">FILTER_BY_ADDON_TYPE</span><span class="o">=</span><span class="s2">&#34;authentication/pinniped&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu cluster create <span class="nv">$cluster</span> --dry-run -f tkgm01.yaml &gt; <span class="nv">$cluster</span>-example-secret.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><p>위와 같이 하면 아래와 같은 파일을 확인 할 수 있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">apiVersion: v1
</span></span><span class="line"><span class="cl">kind: Secret
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  annotations:
</span></span><span class="line"><span class="cl">    tkg.tanzu.vmware.com/addon-type: authentication/pinniped
</span></span><span class="line"><span class="cl">  labels:
</span></span><span class="line"><span class="cl">    clusterctl.cluster.x-k8s.io/move: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    tkg.tanzu.vmware.com/addon-name: pinniped
</span></span><span class="line"><span class="cl">    tkg.tanzu.vmware.com/cluster-name: tkgm02
</span></span><span class="line"><span class="cl">  name: cjenm-tkgm02-pinniped-addon
</span></span><span class="line"><span class="cl">  namespace: tkg-system
</span></span><span class="line"><span class="cl">stringData:
</span></span><span class="line"><span class="cl">  values.yaml: <span class="p">|</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#@data/values</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#@overlay/match-child-defaults missing_ok=True</span>
</span></span><span class="line"><span class="cl">    ---
</span></span><span class="line"><span class="cl">    infrastructure_provider: vsphere
</span></span><span class="line"><span class="cl">    tkg_cluster_role: management
</span></span><span class="line"><span class="cl">    custom_cluster_issuer: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    custom_tls_secret: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    http_proxy: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    https_proxy: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    no_proxy: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    identity_management_type: oidc
</span></span><span class="line"><span class="cl">    pinniped:
</span></span><span class="line"><span class="cl">      cert_duration: 2160h
</span></span><span class="line"><span class="cl">      cert_renew_before: 360h
</span></span><span class="line"><span class="cl">      supervisor_svc_endpoint: https://0.0.0.0:31234
</span></span><span class="line"><span class="cl">      supervisor_ca_bundle_data: ca_bundle_data_of_supervisor_svc
</span></span><span class="line"><span class="cl">      supervisor_svc_external_ip: 0.0.0.0
</span></span><span class="line"><span class="cl">      supervisor_svc_external_dns: null
</span></span><span class="line"><span class="cl">      upstream_oidc_client_id: <span class="o">{</span>CLIENT ID<span class="o">}</span>
</span></span><span class="line"><span class="cl">      upstream_oidc_client_secret: <span class="o">{</span>CLIENT SECRET<span class="o">}</span>
</span></span><span class="line"><span class="cl">      upstream_oidc_issuer_url: https://<span class="o">{</span>KEYCLAOK FQDN<span class="o">}</span>:8443/realms/access
</span></span><span class="line"><span class="cl">      upstream_oidc_tls_ca_data: <span class="o">{</span>base64로 CA인증서<span class="o">}</span>
</span></span><span class="line"><span class="cl">      upstream_oidc_additional_scopes:
</span></span><span class="line"><span class="cl">      - openid
</span></span><span class="line"><span class="cl">      - profile
</span></span><span class="line"><span class="cl">      - email
</span></span><span class="line"><span class="cl">      - groups
</span></span><span class="line"><span class="cl">      - offline_access
</span></span><span class="line"><span class="cl">      upstream_oidc_claims:
</span></span><span class="line"><span class="cl">        username: email
</span></span><span class="line"><span class="cl">        groups: groups
</span></span><span class="line"><span class="cl">      supervisor:
</span></span><span class="line"><span class="cl">        service:
</span></span><span class="line"><span class="cl">          name: pinniped-supervisor
</span></span><span class="line"><span class="cl">          type: LoadBalancer
</span></span><span class="line"><span class="cl">type: tkg.tanzu.vmware.com/addon
</span></span></code></pre></td></tr></table>
</div>
</div><p>실행</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f <span class="nv">$cluster</span>-example-secret.yaml -n tkg-system
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>완료 후 테스트</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu mc kubeconfig get --export-file<span class="o">=</span>tanzu-cli-tkgm02
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get pod -A --kubeconfig tanzu-cli-tkgm02
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>요청</h4>
        </figcaption>
</figure>

<p>생성한 계정으로 로그인
<figure><figcaption>
            <h4>LOGIN</h4>
        </figcaption>
</figure>
</p>
<p>TOKEN을 얻을 수 있다.
<figure><figcaption>
            <h4>TOKEN 얻기</h4>
        </figcaption>
</figure>
</p>
<p>TOKEN을 붙여 넣으면 아래와 같이 요청이 되는 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>kubectl 요청</h4>
        </figcaption>
</figure>
</p>
<p>만약 권한이 없다면 아래 처럼 권한이 없다고 나온다.
<figure><figcaption>
            <h4>kubectl 요청</h4>
        </figcaption>
</figure>
</p>
]]></description>
</item><item>
    <title>The Documentation Tanzu &amp; OTKA</title>
    <link>https://huntedhappy.github.io/ko/tanzu-okta/</link>
    <pubDate>Fri, 15 Jul 2022 17:17:42 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/tanzu-okta/</guid>
    <description><![CDATA[<h2 id="1-tanzu와-okta-연동">1. TANZU와 OKTA 연동</h2>
<p>TANZU는 기본적으로 LDAPS 또는 OIDC와 연동이 가능합니다. 그 중에 OKTA 서비스를 활용하여 TANZU와 OKTA를 연동 하겠습니다.
OKTA는 기본적으로 30일간 무료로 사용이 가능합니다.</p>
<h2 id="2-okta-구성">2. OKTA 구성</h2>
<p>OKTA접속 후 관리자로 변경</p>
<figure><figcaption>
            <h4>관리자로 변경</h4>
        </figcaption>
</figure>

<p>Application 추가</p>
<p><figure><figcaption>
            <h4>Apps 추가</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Apps 추가</h4>
        </figcaption>
</figure>
</p>
<p>redirect URIs는 kubectl get svc를 통해 확인
<figure><figcaption>
            <h4>Apps 추가</h4>
        </figcaption>
</figure>
</p>
<figure><figcaption>
            <h4>Redirect URIs 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Sign On 수정</h4>
        </figcaption>
</figure>

<p>Group을 생성은 Optional
<figure><figcaption>
            <h4>Groups 생성 및 Assignment</h4>
        </figcaption>
</figure>
</p>
<figure><figcaption>
            <h4>APP Assign</h4>
        </figcaption>
</figure>

<p><figure><figcaption>
            <h4>APP Assign</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>APP Assign</h4>
        </figcaption>
</figure>
</p>
<h2 id="3-tanzu-구성">3. TANZU 구성</h2>
<p>OIDC_IDENTITY_PROVIDER_CLIENT_SECRET를 base64로 변경 필요</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> -n <span class="s1">&#39;{CLIENT SECRETS}&#39;</span> <span class="p">|</span> base64
</span></span></code></pre></td></tr></table>
</div>
</div><p>TANZU MGMT 에서 OIDC 부분을 찾은 후 파일 수정</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">IDENTITY_MANAGEMENT_TYPE: <span class="s2">&#34;oidc&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#! Settings for IDENTITY_MANAGEMENT_TYPE: &#34;oidc&#34;</span>
</span></span><span class="line"><span class="cl">CERT_DURATION: 2160h
</span></span><span class="line"><span class="cl">CERT_RENEW_BEFORE: 360h
</span></span><span class="line"><span class="cl">IDENTITY_MANAGEMENT_TYPE: oidc
</span></span><span class="line"><span class="cl">OIDC_IDENTITY_PROVIDER_CLIENT_ID: 0oa2i<span class="o">[</span>...<span class="o">]</span>NKst4x7
</span></span><span class="line"><span class="cl">OIDC_IDENTITY_PROVIDER_CLIENT_SECRET: &lt;encoded:LVVnMFNsZFIy<span class="o">[</span>...<span class="o">]</span><span class="nv">TMTV3WUdPZDJ2Xw</span><span class="o">==</span>&gt;
</span></span><span class="line"><span class="cl">OIDC_IDENTITY_PROVIDER_GROUPS_CLAIM: groups
</span></span><span class="line"><span class="cl">OIDC_IDENTITY_PROVIDER_ISSUER_URL: https://dev-<span class="o">[</span>...<span class="o">]</span>.okta.com
</span></span><span class="line"><span class="cl">OIDC_IDENTITY_PROVIDER_SCOPES: openid,profile,email,groups,offline_access
</span></span><span class="line"><span class="cl">OIDC_IDENTITY_PROVIDER_USERNAME_CLAIM: email
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="4-sa-생성-후-test">4. SA 생성 후 TEST</h2>
<p>SA 생성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create clusterrolebinding id-mgmt-test-user --clusterrole cluster-admin --user <span class="o">{</span>mail address<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>TEST</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu mc kubeconfig get --export-file<span class="o">=</span>tanzu-cli-tkgm02
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get pod -A --kubeconfig tanzu-cli-tkgm02
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>TEST</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TEST</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TEST</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TEST</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>TEST</h4>
        </figcaption>
</figure>
</p>
]]></description>
</item><item>
    <title>The Documentation Networks</title>
    <link>https://huntedhappy.github.io/ko/networks/</link>
    <pubDate>Sun, 10 Apr 2022 18:32:52 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/networks/</guid>
    <description><![CDATA[<h2 id="0-osi-7-layer">0. OSI 7 Layer</h2>
<figure><figcaption>
            <h4>OSI 7Layer</h4>
        </figcaption>
</figure>

<h3 id="01-ethernet-frame">0.1. Ethernet Frame</h3>
<figure><figcaption>
            <h4>EthernetFrame</h4>
        </figcaption>
</figure>

<h3 id="02-ethernet-header--2-layer">0.2. Ethernet Header ( 2 Layer)</h3>
<p>Destination Address 6 bytes = 48 bits</p>
<ul>
<li>목적지 맥 주소 6 bytes(48bits), 주소의 첫 번째 비트가 1이면 멀티캐스트 이며, 모든 비트가 1이면 브로드캐스트이다.
FF:FF:FF:FF:FF = Broadcast</li>
</ul>
<p>Source Address 6 bytes = 48 bits</p>
<ul>
<li>출발지 맥 주소 6 bytes(48bits)</li>
</ul>
<p>802.1q tag 4 bytes = 32 bits</p>
<ul>
<li>L2에서 VLAN 설정</li>
</ul>
<p>Ethernet Type 2 bytes = 16 bits</p>
<ul>
<li>Ethernet 및 802.3 와의 호환성을 위한 구분 방법 (Len/Type : 길이 또는 타입)
<ul>
<li>
<p>0x 600 이하이면 =&gt; Length (IEEE 802.3) 로 해석</p>
<ul>
<li>Length : 수납되는 LLC 프레임 길이(3~1500 바이트)를 나타냄   ☞  MTU</li>
</ul>
</li>
<li>
<p>0x 600 이상이면 =&gt; Type (DIX 2.0) 로 해석</p>
<ul>
<li>Type   : Data에 담겨있는 상위 프로토콜 종류</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>Type Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0600h</td>
<td>Xerox XNS IDP</td>
</tr>
<tr>
<td>0x0800h</td>
<td>IPv4</td>
</tr>
<tr>
<td>0x0805h</td>
<td>X.25</td>
</tr>
<tr>
<td>0x0806h</td>
<td>ARP</td>
</tr>
<tr>
<td>0x0835h</td>
<td>RARP</td>
</tr>
<tr>
<td>0x6003h</td>
<td>DEC DECnet Phase IV</td>
</tr>
<tr>
<td>0x8100h</td>
<td>VLAN ID</td>
</tr>
<tr>
<td>0x8137h</td>
<td>Novell Netware IPX</td>
</tr>
<tr>
<td>0x8191h</td>
<td>NetBIOS</td>
</tr>
<tr>
<td>0x86DDh</td>
<td>IPv6</td>
</tr>
<tr>
<td>0x8847h</td>
<td>MPLS }</td>
</tr>
<tr>
<td>0x8863h</td>
<td>PPPoE Discovery Stage</td>
</tr>
<tr>
<td>0x8864h</td>
<td>PPPoE PPP Session Stage</td>
</tr>
<tr>
<td>0x888Eh</td>
<td>IEEE 802.1X</td>
</tr>
<tr>
<td>0x88CCh</td>
<td>LLDP (Link Layer Discovery Protocol)</td>
</tr>
</tbody>
</table>
<h3 id="03-ip-header-3-layer">0.3. IP Header (3 Layer)</h3>
<figure><figcaption>
            <h4>IP Header</h4>
        </figcaption>
</figure>

<p>windows에서 MTU 사이즈 확인 하는 방법</p>
<p>ping Option 설정 -l size , -f 조각화 하지 않음, IP 20 bytes, ICMP 8 bytes</p>
<p>1500 - (IP + ICMP) = 1472</p>
<p>ping -l -f 1472</p>
<figure><figcaption>
            <h4>ICMP로 확인</h4>
        </figcaption>
</figure>

<p>명령어로 MTU 확인
netsh interface ipv4 show interfaces</p>
<figure><figcaption>
            <h4>netsh로 확인</h4>
        </figcaption>
</figure>

<p>변경은 아래 명령어로 가능하다. (변경시 상단 스위치에서도 변경 필요, 변경 하지 않으면 단편화가 된다.)
netsh interface ipv4 set subinterface &ldquo;색인 번호&rdquo; 또는 &ldquo;이름&rdquo; 으로 변경이 가능하다.</p>
<p>netsh interface ipv4 set subinterface &ldquo;10&rdquo; mtu=9000 store=persistent</p>
<p>netsh interface ipv4 set subinterface &ldquo;이더넷 2&rdquo; mtu=9000 store=persistent</p>
<h3 id="04-tcp-header-4-layer">0.4. TCP Header (4 Layer)</h3>
<figure><figcaption>
            <h4>TCP Header</h4>
        </figcaption>
</figure>

<p>Source port (16 bits)</p>
<ul>
<li>출발지 port</li>
</ul>
<p>Destination port (16 bits)</p>
<ul>
<li>목적지 port</li>
</ul>
<p>Sequence number (32 bits)</p>
<ul>
<li>패킷의 순서</li>
</ul>
<p>Acknowledgment number (32 bits)</p>
<p>Data offset (4 bits)</p>
<ul>
<li>TCP 헤더의 크기를 32 bits로 지정</li>
</ul>
<p>Reserved (3 bits)</p>
<ul>
<li>향후 사용을 위해 0으로 설정 (현재는 사용하지 않음)</li>
</ul>
<p>Flags (9 bits)</p>
<ul>
<li>다음과 같은 9개의 1비트 플래그(제어 비트)를 포함합니다.</li>
<li>NS(1비트): ECN-nonce - 은폐 보호 [a]</li>
<li>CWR(1비트): CWR(Congestion Window Reduced) 플래그는 송신 호스트가 ECE 플래그가 설정된 TCP 세그먼트를 수신하고 혼잡 제어 메커니즘에서 응답했음을 나타내기 위해 설정됩니다. [비]</li>
<li>ECE(1비트): ECN-Echo는 SYN 플래그 값에 따라 이중 역할을 합니다. 다음을 나타냅니다.
<ul>
<li>SYN 플래그가 설정되면(1), TCP 피어는 ECN 을 사용할 수 있습니다.</li>
<li>SYN 플래그가 클리어(0)이면 IP 헤더에 Congestion Experienced 플래그(ECN=11)가 설정된 패킷이 정상 전송 중에 수신되었음을 나타냅니다. [b] 이것은 TCP 발신자에게 네트워크 정체(또는 임박한 정체)를 나타내는 역할을 합니다.</li>
</ul>
</li>
<li>URG(1비트): 긴급 포인터 필드가 중요함을 나타냅니다.</li>
<li>ACK(1비트): Acknowledgement 필드가 중요함을 나타냅니다. 클라이언트가 보낸 초기 SYN 패킷 이후의 모든 패킷에는 이 플래그가 설정되어 있어야 합니다.</li>
<li>PSH(1비트): 푸시 기능. 버퍼링된 데이터를 수신 애플리케이션에 푸시하도록 요청합니다.</li>
<li>RST(1비트): 연결 재설정</li>
<li>SYN(1비트): 시퀀스 번호를 동기화합니다. 각 끝에서 보낸 첫 번째 패킷에만 이 플래그가 설정되어야 합니다. 일부 다른 플래그 및 필드는 이 플래그를 기반으로 의미를 변경하며 일부는 설정된 경우에만 유효하고 다른 일부는 해제된 경우에만 유효합니다.</li>
<li>FIN(1비트): 보낸 사람의 마지막 패킷</li>
</ul>
<p>Windows size (16 bits)
한번에 받을 수 있는 데이터의 양이며 최대 64Kbytes 까지 가능하다.PC에서 Windows Size만큼 한번에 전송 후에 ACK를 기다린다.
Windows Szie는 가변적이므로 통신에 문제가 없으면 Size를 늘리고, 문제가 발생 한다면 Size를 줄인다. 이렇게 늘렸다 줄였다 하는 것을 Sliding Window라고 하며 이렇게 전송속도를 제어 하는 것을 Flow-Control이라고 부른다.</p>
<p>Checksum (16 bits)</p>
<ul>
<li>16비트 체크섬 필드는 TCP 헤더, 페이로드 및 IP 의사 헤더의 오류 검사에 사용됩니다. 의사 헤더는 소스 IP 주소 , 대상 IP 주소 , TCP 프로토콜의 프로토콜 번호 (6), TCP 헤더 및 페이로드의 길이(바이트)로 구성됩니다.</li>
</ul>
<p><a href="https://4network.tistory.com/entry/Sliding-Window-%EA%B0%9C%EB%85%90-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0?category=286056" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> Sliding Window 참고 블로그 </a></p>
<p><a href="https://en.wikipedia.org/wiki/Ethernet_frame" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> Ethernet frame wiki </a></p>
<p><a href="https://en.wikipedia.org/wiki/IPv4" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> IP Header wiki  </a></p>
<p><a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> TCP Header wiki  </a></p>
<p><a href="http://www.ktword.co.kr/test/view/view.php?m_temp1=2039" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> Ethernet Type 참고 </a></p>
<h4 id="041-fin-fin-wait관련">0.4.1. (FIN, FIN-WAIT)관련</h4>
<figure><figcaption>
            <h4>FIN</h4>
        </figcaption>
</figure>

<p>FIN_WAIT1 상태</p>
<ul>
<li>A가 B에게 Connection을 Close하면서, 종료 신호인 FIN segment를 A에서 B에게 보내고, A는 FIN_WAIT_1 상태가 된다.
(이때 A System의 User는 더이상의 SEND는 사용 할 수 없고, RECIEVE는 계속 가능)</li>
</ul>
<p>CLOSE_WAIT 상태</p>
<ul>
<li>B가 신호를 받으면 B는 CLOSE_WAIT에 들어가면서 그에 대한 ACK을 보낸다.</li>
</ul>
<p>FIN_WAIT2 상태</p>
<ul>
<li>A는 FIN_WAIT2상태가 되고, B는 Connection Close하면서 FIN을 보낸다.</li>
</ul>
<p>TIME_WAIT 상태</p>
<ul>
<li>A는 TIME_WAIT상태가 되어 최종적으로 B와의 Connection이 닫히는지 확인 한다.</li>
</ul>
<p>즉 서버가 클라이언트로 부터 FIN에 대한 ACK을 받고나서 클라이언트의 FIN을 기다리는 상태가 FIN_WAIT2 상태이다.</p>
<h3 id="05-overlay">0.5. Overlay</h3>
<h4 id="051-vxlan">0.5.1. VXLAN</h4>
<p>Outer IP Header 20 Bytes + UDP Header 8 bytes + VXLAN 8 bytes + Inner Ethernet 18 bytes</p>
<p>VLAN 포함</p>
<p>20 + 8 + 8 + 18 = 54</p>
<p>만약 VLAN이 포함 되어 있지 않다면</p>
<p>20 + 8 + 8 + 14 = 50</p>
<p>그래서 1500 + 54 = 1554 가 필요 하지만 계산하기 편하게 1600 이상으로 설정 하는 것을 권고 한다.
또한 요새는 SDN 제품들이 jumbo frame(9000) 으로 기본 셋팅 되어서 나오기 때문에 9000으로 설정을 해도 된다.</p>
<figure><figcaption>
            <h4>VXLAN</h4>
        </figcaption>
</figure>

<h4 id="052-geneve">0.5.2. GENEVE</h4>
<figure><figcaption>
            <h4>GENEVE#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>GENEVE#2</h4>
        </figcaption>
</figure>

<table>
<thead>
<tr>
<th>PARAMETER</th>
<th>VXLAN</th>
<th>GENEVE</th>
</tr>
</thead>
<tbody>
<tr>
<td>Abbreviation for</td>
<td>VXLAN (Virtual Extensible LAN)</td>
<td>GENEVE (Generic Network Virtualization Encapsulation)</td>
</tr>
<tr>
<td>Developed by</td>
<td>VMware, Arista Networks and Cisco</td>
<td>VMware, Microsoft, Red Hat and Intel</td>
</tr>
<tr>
<td>Protocol</td>
<td>UDP</td>
<td>UDP</td>
</tr>
<tr>
<td>Port No</td>
<td>4789</td>
<td>6081</td>
</tr>
<tr>
<td>Header Length</td>
<td>8 bytes</td>
<td>16 bytes</td>
</tr>
<tr>
<td>Transport security, service chaining, in-band telemetry</td>
<td>Not Supported</td>
<td>Supported</td>
</tr>
<tr>
<td>RFC</td>
<td>VXLAN is officially documented by the IETF in RFC 7348</td>
<td>RFC 8926</td>
</tr>
<tr>
<td>Protocol Identifier</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Non-Client Payload Indication</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Extensibility</td>
<td>No. Infact all fields in VXLAN header have predefined value</td>
<td>Yes</td>
</tr>
<tr>
<td>Hardware friendly vendor extensibility mechanism</td>
<td>Limited</td>
<td>Yes</td>
</tr>
<tr>
<td>Term used for Tunnel Endpoints</td>
<td>VTEP</td>
<td>TEP</td>
</tr>
</tbody>
</table>
<p><a href="https://ipwithease.com/vxlan-vs-geneve-understand-the-difference/" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> VXLAN - GENEVE 참고  </a></p>
<h2 id="1-l2">1. L2</h2>
<h3 id="11-mac주소">1.1. MAC주소</h3>
<p>MAC은 일반적으로 OSI 7 Layer중에서 2 Layer에 속한다. 확인하는 방법은 윈두우에서 CMD창을 연 후 ipconfig /all명령어를 사용하면 확인할 수 있다. 나오는 부분중에 물리적 주소라고 나오는 것을 확인 할 수 있다. 리눅스의 경우는 ifconfig라고 치면 바로 확인을 할 수 있을 것이다.</p>
<ul>
<li>물론 H/W 주소이지만 변경은 가능하다. 그러므르 보안적으로 이슈가 될 수 있다.</li>
</ul>
<figure><figcaption>
            <h4>MAC 주소 확인</h4>
        </figcaption>
</figure>

<p>확인을 하게 되면
E0-3F-49-AB-C8-AD
위와 같이 표시가 되며 절반으로 나누어 앞의 세부분은 생산자를 나타내고, 뒤의 세 부분은 장치의 일련번호(Host Identifier)을 나타낸다.</p>
<p><a href="https://regauth.standards.ieee.org/standards-ra-web/pub/view.html#registries" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> MAC 제조회사 찾는 곳 </a>
<figure><figcaption>
            <h4>제조회사 찾는 방법</h4>
        </figcaption>
</figure>
</p>
<h3 id="12-arp--rarp--garp">1.2. ARP &amp; RARP &amp; GARP</h3>
<p>ARP(Address Resolution Protofcol)는 IP주소를 MAC주소와 대응(Bind)시키기 위해 사용되는 프로토콜이다.
IP주소는 알지만 MAC주소를 모르는 경우 사용 할 수 있다.</p>
<p>윈도우에서 arp -a {IP} 로 확인 할 수 있다.
<figure><figcaption>
            <h4>ARP 확인</h4>
        </figcaption>
</figure>
</p>
<p>RARP(Reverse Address Resolution Protocol)는 그 반대로 MAC주소로 IP를 대응(Bind)시키기 위해 사용되는 프로토콜이다.
MAC주소는 알지만 IP주소를 모르는 경우 사용 할 수 있다.</p>
<p>GARP(Gratuitous ARP)는 PC를 스위치에 연결을 하게 되면 나의 IP와 MAC은 이거라고 알리는대 사용한다. 3번정도 GARP를 보낸다. 그래서 IP 주소 충돌을 감지 할 수 있으며, GARP를 수신한 모든 호스트/라우터는 ARP Table을 갱신할 수 있다. 또 다른 목적은 VRRP/HSRP프로토콜에서 사용된다(VRRP/HSRP의 설명은 패스한다).</p>
<p>ARP probe
ARP probe는 sender의 IP주소를 0으로 해서 ARP요청을 하며 IPv4 주소의 충돌을 감지 할 수 있다.</p>
<figure><figcaption>
            <h4>Probe 확인</h4>
        </figcaption>
</figure>

<p>ARP announcements
다른 호스트의 ARP 테이블을 갱신 할 수 있다.
<figure><figcaption>
            <h4>Announcement 확인</h4>
        </figcaption>
</figure>
</p>
<h3 id="13-l2-통신">1.3. L2 통신</h3>
<table>
<thead>
<tr>
<th>기능</th>
<th>설명</th>
<th>기술</th>
</tr>
</thead>
<tbody>
<tr>
<td>learning</td>
<td>출발지 주소가 MAC 테이블에 주소가 없으면 MAC 주소를 저장</td>
<td>MAC table</td>
</tr>
<tr>
<td>flooding</td>
<td>목적지 주소가 MAC 테이블에 없으면 전체 포트로 전달</td>
<td>Broadcast</td>
</tr>
<tr>
<td>filtering</td>
<td>출발지/목적지가 동일 네트워크에 있으면 다른 네트워크로 전파 차단</td>
<td>Collision Domain</td>
</tr>
<tr>
<td>aging</td>
<td>MAC 테이블 캐쉬</td>
<td>Aging Time</td>
</tr>
</tbody>
</table>
<ol>
<li>PC를 연결 하면 PC에서 PROBE를 3번 정도 보내고 Announcement 후 스위치 및 PC에서는 ARP를 Learning한다.</li>
<li>만약 스위치 및 PC에서 arp table이 없으면 aging Time이 끝났거나 또는 GARP를 받지 못했을 경우 또는 ARP테이블이 갱신이 안될 경우, PC 1에서 PC 2로 통신을 할 때 Broadcast(flooding)를 보낸다. 이 때 스위치에서는 동일한 VLAN(Filtering)의 모든 포트로 (목적지 IP:ff:ff:ff:ff:ff) 브로드캐스트를 보낸다.</li>
<li>PC2는 해당 브로드캐스트를 받고 반대로 PC1에게 전달을 하게 된다.</li>
<li>스위치 및 PC는 해당 MAC Table에 저장한다. 그리고 스위치에서 연결된 PC에서 트래픽을 전달 한다.(Forwarding)</li>
</ol>
<figure><figcaption>
            <h4>L2 통신</h4>
        </figcaption>
</figure>

<h2 id="2-l3">2. L3</h2>
<p>라우터에 Dynamic(RIP, EIGRP, OSPF, BGP) 또는 STATIC의 대한 설명은 하지 않는다.</p>
<p>Gateway를 적용 하면 아래와 같이 Gateway의 ARP를 얻기 위핸 Broadcast를 요청 하는 것을 확인 할 수 있다.</p>
<figure><figcaption>
            <h4>GATEWAY</h4>
        </figcaption>
</figure>

<p>동일한 대역의 경우 ARP가 각각의 Host에 등록이 되어 있거나 L2 스위치에 등록이 되어 있기 때문에 G/W가 필요 없다. G/W의 역할은 동일한 대역이 아닌 다른 대역과 통신 하기 위해 동일한 대역이 아닌 대역을 G/W에 물어보기 위해 존재 한다.</p>
<p>PC에서 라우팅 테이블을 확인 해 볼 수 있다.</p>
<p>route print 명령어를 통해 확인 해보자. 만약 피시에 Network Interface가 두개이고 목적지가 각각 다른 NIC으로 향해야 한다면. 
모든 목적지는 G/W로 지정을 하고 STATIC하게 라우팅을 2번 Interface로 테이블을 지정 할 수 있을 것이다. 그리고 만약 동일한 목적지로 라우팅이 잡혀 있다면 METRIC이 더 빠른쪽으로 라우팅을 한다는 것을 확인 할 수 있을 것이다.</p>
<figure><figcaption>
            <h4>route print</h4>
        </figcaption>
</figure>

<p>그리고 MAC주소는 라우터를 거치면서 바뀌게 된다. 아래에서 보듯이
실제 10.253.107.2의 MAC주소는 00:50:56:b0:f8:47 이지만 목적지 Host 10.253.126.25에서 확인하였을 때는 G/W인 10.253.126.1의 MAC주소로 바뀌어서 들어오는 것을 확인 할 수 있다. 
<figure><figcaption>
            <h4>route print</h4>
        </figcaption>
</figure>
</p>
<h2 id="3-l4">3. L4</h2>
<p>L3라우터의 경우 IP N/W을 통해 라우팅 경로(라우팅 경로라고 하면 G/W를 통해 봤듯이 자기가 모르는 대역을 다른 라우터에 물어보기 위한 것이라고 보면 된다. 이에 활용되는 것이 STATIC, RIP, EIGRP, OSPF. BGP가 있으며 하나 하나의 대한 기술적 내용은 기술 하지 않는다.)를 확보하는 반면. L4의 경우 Port까지 확인 한다. 이때부터 세션 베이스라고 보면 된다. 한마디로 라우터의 경우 2개의 물리적인 라우터가 있을 경우 A라는 라우터를 통해 들어온 트래픽이 B라는 트래픽을 통해 나가더라도 통신에 이슈가 발생 하지 않는다.</p>
<figure><figcaption>
            <h4>L3의 경우 Asymmetirc구조라도 상관 없음</h4>
        </figcaption>
</figure>

<p>하지만 L4 Layer이상의 경우 세션 베이스이기 때문에 자기가 가지고 있지 않은 정보가 들어오면 Drop을 한다. 그래서 동일한 경로로 통신을 해야 한다.</p>
<figure><figcaption>
            <h4>L4의 경우 Asymmetirc구조일 경우 Drop</h4>
        </figcaption>
</figure>

<p>또한 기술적으로 LoadBalancer의 경우 One-Arm구성 일 경우 어떻게 구성해야되는지의 대한 여러가지 방안들이 있지만 단순하게 어떻게 통신을 한다는지의 대한 내용만 적었다.. 마찬가지로 LoadBalancer의 경우 다양한 기술이 포함되어 있기 때문에 이렇게 되면 안됩니다. 라는 정도만 작성했다.</p>
<h2 id="4-https-이야기">4. HTTPS 이야기</h2>
<p>HTTPS는 공개키와 비공개키를 사용한다. 이유는 공개키는 비공개키보다 암/복호화 하는대 더 많은 트래픽이 필요 하기 때문에 공개키로 비공개키를 암호화하여 비공개키를 안전하게 전달 후 비공개키를 통해 데이터를 전달한다.</p>
<p><figure><figcaption>
            <h4>HTTPS 이야기</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HTTPS 이야기</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HTTPS 이야기</h4>
        </figcaption>
</figure>
</p>
<ol>
<li>
<p>클라이언 헬로우 : &lt; sslversion, random number, cipersuites, session id 포함&gt;</p>
<ul>
<li>ciphersuites 복수인 이유는 클라이언트에서 어떤 암호화 프로토콜이 있는지 서버에게 알려주게 된다.</li>
</ul>
</li>
<li>
<p>서버 헬로우 : &lt; sslversion, random number, ciphersuit, session id 포함 &gt;</p>
<ul>
<li>사이트의 ciphersuite 단수인데요. 이유는 클라이언트가 보내준 암호화중에 제일 암호화가 높은것으로 선택</li>
</ul>
</li>
<li>
<p>사용자의 웹브라우저에는 인증기관의 공개키가 이미 내장되어 있기 때문에 내장된 공개키로 인증서가 제대로된 인증서인지 판단</p>
<ul>
<li>가끔 브라우저 버전이 낮으면 최신 인증기관의 정보가 없을 수 있다.</li>
<li>만약에 사설 인증서일 경우 인증된 인증서가 아닐 뿐 사아트에서는 공개키를 전달 했기 때문에 전달 받은 공개키로 대칭키를 암호화(Pre-Master-Secret) 한다.</li>
</ul>
</li>
<li>
<p>사용자는 사이트에서 얻은 공개키를 이용하여, PMS(Pre-Master-Secret)를 암호화</p>
<ul>
<li>(Pre-Master-Secret)는 사용자가 Hello 보낼때 들어가있는 randomKey, 서버가 hello 할때 random key를 조합하여 만듦</li>
</ul>
</li>
<li>
<p>사이트는 자기의 개인키로 사용자가 공개키로 암호화한것을 복호화 하여 안에 들어있는 Pre-Master-Secret를 이용하여 사용자와 메시지를 주고 받음</p>
</li>
<li>
<p>Pre-Master-Secret는 master Secret을 만들고 master-Secret 은 세션키를 생성 이후 세션키 값을 이용하여 아까 했던 일련의 상황들을 모두 reuse를 하여 복잡한 방식을 모두 하지 않고 대칭키 방식으로 메시지를 주고 받습니다.</p>
</li>
</ol>
<ul>
<li>공인된 인증기관에서 발급 받은 인증서의 경우 기본적으로 인증서에는 공개키와 개인키가 포함되어 있기 때문에 이미 브라우저에 내장되어 있는 인증기관의 공개키로 복호화 하여 사이트가 인증기관에서 인증을 받은 사이트라는것을 검증 한다. 만약 사설 인증서인 경우 웹브라우저에서 검증되지 않는 사이트라고 나오며 * 이는 인증기관에서 인증되지 않는 사이트라는 것만 검사 할뿐 이를 무시를 하게 되면 서버에서는 이미 공개키를 전달 했기 때문에 해당 공개키를 가지고 대칭키를 암호화 하여 사이트에 전달을 하게 된다 그리고 사이트에는 개인키로 복호화 하여 대칭키를 획득 한 후 대칭키로 암/복호화를 하여 데이터를 주고 받게 된다.</li>
</ul>
<h2 id="5-유저에서-웹서핑-까지">5. 유저에서 웹서핑 까지</h2>
<figure><figcaption>
            <h4>웹서핑</h4>
        </figcaption>
</figure>

<ol>
<li>
<p>사용자가 웹서핑을 하기 위해 브라우저에서 해당하는 DOMAIN을 입력한다. 예를 들어 <a href="http://www.naver.com" target="_blank" rel="noopener noreffer">www.naver.com</a>을 입력하게 되면 최초로 LDNS에게 요청하게 된다. LDNS는 자기가 잡은 DNS를 LDSN라고 한다.</p>
</li>
<li>
<p>LDSN에서는 해당 도메인의 ROOT DNS에 쿼리를 날린다.</p>
</li>
<li>
<p>ROOT DNS는 하위 DNS인 .COM의 IP를 응답해준다.</p>
</li>
<li>
<p>.COM의 DNS는 하위 DNS인 naver.com의 DNS의 IP를 응답해준다.</p>
</li>
<li>
<p>naver.com은 실제적으로 <a href="http://www.naver.com" target="_blank" rel="noopener noreffer">www.naver.com</a>의 A 레코드를 가지고 있으면 LDNS에게 응답을 해주고 LDNS는 최종적으로 사용자에게 <a href="http://www.naver.com" target="_blank" rel="noopener noreffer">www.naver.com</a>의 IP를 알려주게 된다.</p>
</li>
</ol>
]]></description>
</item><item>
    <title>The Documentation vSphere Tanzu with AVI Load Balancer</title>
    <link>https://huntedhappy.github.io/ko/avi/</link>
    <pubDate>Tue, 05 Apr 2022 21:51:24 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/avi/</guid>
    <description><![CDATA[<h2 id="1-tanzu에서-cluster-servicetype-변경">1. TANZU에서 Cluster ServiceType 변경</h2>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>serviceType<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>ManageMent Cluster로 Context 변경</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">### NodePort 변경</span>
</span></span><span class="line"><span class="cl">kubectl apply -f - <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.tkg.tanzu.vmware.com/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: AKODeploymentConfig
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: nodeport01
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  adminCredentialRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: avi-controller-credentials
</span></span></span><span class="line"><span class="cl"><span class="s">    namespace: tkg-system-networking
</span></span></span><span class="line"><span class="cl"><span class="s">  certificateAuthorityRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: avi-controller-ca
</span></span></span><span class="line"><span class="cl"><span class="s">    namespace: tkg-system-networking
</span></span></span><span class="line"><span class="cl"><span class="s">  cloudName: Default-Cloud
</span></span></span><span class="line"><span class="cl"><span class="s">  clusterSelector:
</span></span></span><span class="line"><span class="cl"><span class="s">    matchLabels:
</span></span></span><span class="line"><span class="cl"><span class="s">      ako-l7-nodeport-01: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  controller: avi.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">  dataNetwork:
</span></span></span><span class="line"><span class="cl"><span class="s">    cidr: 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">    name: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">  extraConfigs:
</span></span></span><span class="line"><span class="cl"><span class="s">    cniPlugin: antrea
</span></span></span><span class="line"><span class="cl"><span class="s">    disableStaticRouteSync: false
</span></span></span><span class="line"><span class="cl"><span class="s">    l4Config:
</span></span></span><span class="line"><span class="cl"><span class="s">      autoFQDN: disabled
</span></span></span><span class="line"><span class="cl"><span class="s">    ingress:
</span></span></span><span class="line"><span class="cl"><span class="s">      defaultIngressController: true
</span></span></span><span class="line"><span class="cl"><span class="s">      disableIngressClass: false  
</span></span></span><span class="line"><span class="cl"><span class="s">      nodeNetworkList:
</span></span></span><span class="line"><span class="cl"><span class="s">        - cidrs:
</span></span></span><span class="line"><span class="cl"><span class="s">            - 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">          networkName: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">      serviceType: NodePort
</span></span></span><span class="line"><span class="cl"><span class="s">      shardVSSize: SMALL
</span></span></span><span class="line"><span class="cl"><span class="s">  serviceEngineGroup: Default-Group
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">### ClusterIP 변경</span>
</span></span><span class="line"><span class="cl">kubectl apply -f - <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.tkg.tanzu.vmware.com/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: AKODeploymentConfig
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: clusterip01
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  adminCredentialRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: avi-controller-credentials
</span></span></span><span class="line"><span class="cl"><span class="s">    namespace: tkg-system-networking
</span></span></span><span class="line"><span class="cl"><span class="s">  certificateAuthorityRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: avi-controller-ca
</span></span></span><span class="line"><span class="cl"><span class="s">    namespace: tkg-system-networking
</span></span></span><span class="line"><span class="cl"><span class="s">  cloudName: Default-Cloud
</span></span></span><span class="line"><span class="cl"><span class="s">  clusterSelector:
</span></span></span><span class="line"><span class="cl"><span class="s">    matchLabels:
</span></span></span><span class="line"><span class="cl"><span class="s">      ako-l7-clusterip-01: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  controller: avi.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">  dataNetwork:
</span></span></span><span class="line"><span class="cl"><span class="s">    cidr: 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">    name: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">  extraConfigs:
</span></span></span><span class="line"><span class="cl"><span class="s">    cniPlugin: antrea
</span></span></span><span class="line"><span class="cl"><span class="s">    disableStaticRouteSync: false                               # required
</span></span></span><span class="line"><span class="cl"><span class="s">    l4Config:
</span></span></span><span class="line"><span class="cl"><span class="s">      autoFQDN: disabled
</span></span></span><span class="line"><span class="cl"><span class="s">    ingress:
</span></span></span><span class="line"><span class="cl"><span class="s">      defaultIngressController: true
</span></span></span><span class="line"><span class="cl"><span class="s">      disableIngressClass: false                                # required
</span></span></span><span class="line"><span class="cl"><span class="s">      nodeNetworkList:                                          # required
</span></span></span><span class="line"><span class="cl"><span class="s">        - cidrs:
</span></span></span><span class="line"><span class="cl"><span class="s">            - 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">          networkName: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">      serviceType: ClusterIP                                    # required
</span></span></span><span class="line"><span class="cl"><span class="s">      shardVSSize: SMALL                                       # required
</span></span></span><span class="line"><span class="cl"><span class="s">  serviceEngineGroup: Default-Group
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">### NodePortLocal 변경</span>
</span></span><span class="line"><span class="cl">kubectl apply -f - <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.tkg.tanzu.vmware.com/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: AKODeploymentConfig
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: npl-enabled
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  adminCredentialRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: avi-controller-credentials
</span></span></span><span class="line"><span class="cl"><span class="s">    namespace: tkg-system-networking
</span></span></span><span class="line"><span class="cl"><span class="s">  certificateAuthorityRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: avi-controller-ca
</span></span></span><span class="line"><span class="cl"><span class="s">    namespace: tkg-system-networking
</span></span></span><span class="line"><span class="cl"><span class="s">  cloudName: Default-Cloud
</span></span></span><span class="line"><span class="cl"><span class="s">  clusterSelector:
</span></span></span><span class="line"><span class="cl"><span class="s">    matchLabels:
</span></span></span><span class="line"><span class="cl"><span class="s">      npl-enabled: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  controlPlaneNetwork:
</span></span></span><span class="line"><span class="cl"><span class="s">    cidr: 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">    name: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">  controller: avi.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">  dataNetwork:
</span></span></span><span class="line"><span class="cl"><span class="s">    cidr: 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">    name: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">  extraConfigs:
</span></span></span><span class="line"><span class="cl"><span class="s">    cniPlugin: antrea
</span></span></span><span class="line"><span class="cl"><span class="s">    disableStaticRouteSync: false                               # required
</span></span></span><span class="line"><span class="cl"><span class="s">    l4Config:
</span></span></span><span class="line"><span class="cl"><span class="s">      autoFQDN: disabled
</span></span></span><span class="line"><span class="cl"><span class="s">    ingress:
</span></span></span><span class="line"><span class="cl"><span class="s">      defaultIngressController: true
</span></span></span><span class="line"><span class="cl"><span class="s">      disableIngressClass: false                               
</span></span></span><span class="line"><span class="cl"><span class="s">      nodeNetworkList:                                          
</span></span></span><span class="line"><span class="cl"><span class="s">        - cidrs:
</span></span></span><span class="line"><span class="cl"><span class="s">            - 10.253.127.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">          networkName: LS_TKGM_10.253.127.x
</span></span></span><span class="line"><span class="cl"><span class="s">      serviceType: NodePortLocal                                     # required
</span></span></span><span class="line"><span class="cl"><span class="s">      shardVSSize: SMALL                                       
</span></span></span><span class="line"><span class="cl"><span class="s">  serviceEngineGroup: Default-Group
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p>NodePort 테스트</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl config use-context <span class="o">{</span>Management Cluster<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get cluster --show-labels
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl label cluster tkgm01-tkc-dev01 ako-l7-nodeport-01<span class="o">=</span><span class="nb">true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl config use-context <span class="o">{</span>TKC<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl create deploy hello --image<span class="o">=</span>paulbouwer/hello-kubernetes:1.7 --replicas<span class="o">=</span><span class="m">3</span> --port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl expose deployment hello --type<span class="o">=</span>NodePort --port<span class="o">=</span><span class="m">80</span> --target-port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl create ingress hello --class<span class="o">=</span>avi-lb --rule<span class="o">=</span><span class="s2">&#34;hello.avi.tkg.io/=hello:8080&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>접속 화면</h4>
        </figcaption>
</figure>

<p>NodePort로 구성이 되어 있기 때문에 아래와 같이 NodeIP와 30000번대의 Port로 서버풀이 지정되는 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>AVI VS 상태 확인</h4>
        </figcaption>
</figure>
</p>
<p>ClusterIP 테스트</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl config use-context <span class="o">{</span>Management Cluster<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get cluster --show-labels
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl label cluster tkgm01-tkc-dev01 ako-l7-clusterip-01<span class="o">=</span><span class="nb">true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl config use-context <span class="o">{</span>TKC<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get cm avi-k8s-config -n avi-system -o <span class="nv">jsonpath</span><span class="o">={</span>.data.serviceType<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl create deploy hello --image<span class="o">=</span>paulbouwer/hello-kubernetes:1.7 --replicas<span class="o">=</span><span class="m">3</span> --port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl expose deployment hello --type<span class="o">=</span>ClusterIP --port<span class="o">=</span><span class="m">80</span> --target-port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl create ingress hello --class<span class="o">=</span>avi-lb --rule<span class="o">=</span><span class="s2">&#34;hello.avi.tkg.io/=hello:8080&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>ServiceType 변경 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>AVI Routing 확인</h4>
        </figcaption>
</figure>

ClusterIP로 구성이 되어 있기 때문에 아래와 같이 실제 Pod와 실제 Port로 서버풀이 지정되는 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>AVI VS 상태 확인</h4>
        </figcaption>
</figure>
</p>
<h2 id="2-avi-infra-settings">2. AVI Infra Settings</h2>
<p>만약에 하나의 클러스터에서 VS별 SE-GROUP을 분리 하거나, 또는 VS의 IP 대역을 분리 하고 싶을 경우 AVIINFRASETTING을 사용하여 구성을 할 수 있다.
<figure><figcaption>
            <h4>구성</h4>
        </figcaption>
</figure>
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f - <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: ako.vmware.com/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: AviInfraSetting
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: other-infra
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  seGroup:
</span></span></span><span class="line"><span class="cl"><span class="s">    name: Default-Group
</span></span></span><span class="line"><span class="cl"><span class="s">  network:
</span></span></span><span class="line"><span class="cl"><span class="s">    vipNetworks:
</span></span></span><span class="line"><span class="cl"><span class="s">      - networkName: pg-dk-10.253.107.x
</span></span></span><span class="line"><span class="cl"><span class="s">        cidr: 10.253.107.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">    enableRhi: false
</span></span></span><span class="line"><span class="cl"><span class="s">  l7Settings:
</span></span></span><span class="line"><span class="cl"><span class="s">    shardSize: MEDIUM
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl apply -f - <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: IngressClass
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: other-infra
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  controller: ako.vmware.com/avi-lb
</span></span></span><span class="line"><span class="cl"><span class="s">  parameters:
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: ako.vmware.com
</span></span></span><span class="line"><span class="cl"><span class="s">    kind: AviInfraSetting
</span></span></span><span class="line"><span class="cl"><span class="s">    name: other-infra
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>테스트</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create deploy hello --image<span class="o">=</span>paulbouwer/hello-kubernetes:1.7 --replicas<span class="o">=</span><span class="m">3</span> --port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl expose deployment hello --type<span class="o">=</span>ClusterIP --port<span class="o">=</span><span class="m">80</span> --target-port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl create ingress hello --class<span class="o">=</span>other-infra --rule<span class="o">=</span><span class="s2">&#34;hello.avi.tkg.io/=hello:8080&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>VS IP 변경 전</h4>
        </figcaption>
</figure>

아래와 같이 VS IP가 변경 된 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>VS IP 변경 후</h4>
        </figcaption>
</figure>
</p>
<p>기존의 하나의 SE그룹에 모두 VS가 구성이 되어 있다.
<figure><figcaption>
            <h4>SE Group 생성</h4>
        </figcaption>
</figure>
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## SEGROUP을 변경</span>
</span></span><span class="line"><span class="cl">kubectl patch aviinfrasettings other-infra --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;replace&#34;,&#34;path&#34;:&#34;/spec/seGroup/name&#34;,&#34;value&#34;:&#34;tkgm01&#34;}]&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl patch ing hello --patch <span class="s1">&#39;{&#34;spec&#34;: {&#34;ingressClassName&#34;: &#34;other-infra&#34;}}&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>현재는 SE가 기존의 
<figure><figcaption>
            <h4>기존 SE 배포 전</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>다른 SE 그룹으로 변경 후 </h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>다른 SE 그룹으로 변경 후 </h4>
        </figcaption>
</figure>
</p>
<p>위와 같은 방법으로 동일한 클러스터 내에서 FQDN별로 SE-GROUP 또는 IP 대역을 분리 할 수 있다.</p>
<h2 id="3-avi-autoscalling">3. AVI AutoScalling</h2>
<figure><figcaption>
            <h4>AVI Autoscalling 기본 동작 </h4>
        </figcaption>
</figure>

<p><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>autoscalling 재 조정값<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## AVI Controller SSH접속 </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">switchto tenant admin
</span></span><span class="line"><span class="cl">switchto cloud Default-Cloud
</span></span><span class="line"><span class="cl">auto_rebalance
</span></span><span class="line"><span class="cl">save
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">configure serviceenginegroup Default-Group
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">auto_rebalance_interval interval-value 
</span></span><span class="line"><span class="cl">auto_rebalance_criteria option
</span></span><span class="line"><span class="cl">auto_rebalance_capacity_per_se integer-value
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">예시: auto_rebalance_interval <span class="m">300</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">auto_rebalance_criteria 의 옵션 값은 아래와 같음
</span></span><span class="line"><span class="cl">se_auto_rebalance_cpu
</span></span><span class="line"><span class="cl">se_auto_rebalance_mbps
</span></span><span class="line"><span class="cl">se_auto_rebalance_open_conns
</span></span><span class="line"><span class="cl">se_auto_rebalance_pps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">예시: auto_rebalance_capacity_per_se <span class="m">200000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">max_cpu_usage value
</span></span><span class="line"><span class="cl">min_cpu_usage value
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 종합 </span>
</span></span><span class="line"><span class="cl">switchto tenant Avi
</span></span><span class="line"><span class="cl">switchto cloud azure
</span></span><span class="line"><span class="cl">configure serviceenginegroup Default-Group
</span></span><span class="line"><span class="cl">auto_rebalance_interval <span class="m">300</span>
</span></span><span class="line"><span class="cl">auto_rebalance_criteria se_auto_rebalance_pps
</span></span><span class="line"><span class="cl">auto_rebalance_capacity_per_se <span class="m">200000</span>
</span></span><span class="line"><span class="cl">max_cpu_usage <span class="m">70</span>
</span></span><span class="line"><span class="cl">min_cpu_usage <span class="m">30</span>
</span></span><span class="line"><span class="cl">save
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<figure><figcaption>
            <h4>auto_rebalance 변경 전</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>auto_rebalance 변경 후</h4>
        </figcaption>
</figure>
</p>
<figure><figcaption>
            <h4>auto scallingout </h4>
        </figcaption>
</figure>

<h2 id="4-bgp-연동-후-rhiroute-health-injection">4. BGP 연동 후 Rhi(Route Health Injection)</h2>
<p>BGP ECMP를 구성 하여 SE를 탄력적으로 확장을 할 수 있습니다.</p>
<p>물리 스위치에는 ECMP를 구성이 필요.</p>
<figure><figcaption>
            <h4>구성</h4>
        </figcaption>
</figure>

<p>AVI에서 BGP 설정
<figure><figcaption>
            <h4>BGP 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>BGP 설정</h4>
        </figcaption>
</figure>
</p>
<p>SE에 접속 해서 BGP 상태를 확인 한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## AVI Controller SSH 접속</span>
</span></span><span class="line"><span class="cl">shell
</span></span><span class="line"><span class="cl">admin /  <span class="o">{</span>password<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">## 서비스 엔진 접속</span>
</span></span><span class="line"><span class="cl">attach serviceengine tkcdevAvi-se-jpjbe
</span></span><span class="line"><span class="cl">ip netns
</span></span><span class="line"><span class="cl"><span class="c1">## 서비스 엔진 bash 접속</span>
</span></span><span class="line"><span class="cl">sudo ip netns <span class="nb">exec</span> avi_ns1 bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## BGP 확인</span>
</span></span><span class="line"><span class="cl">netcat localhost bgpd
</span></span><span class="line"><span class="cl"><span class="nb">enable</span>
</span></span><span class="line"><span class="cl">show run
</span></span><span class="line"><span class="cl">show bgp summary
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>BGP 상태 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>BGP 상태 확인</h4>
        </figcaption>
</figure>
</p>
<p>RHI Enabled</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl patch aviinfrasettings other-infra --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;replace&#34;,&#34;path&#34;:&#34;/spec/network/enableRhi&#34;,&#34;value&#34;:true}]&#39;</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>Rhi Enable</h4>
        </figcaption>
</figure>

<p>스위치에서 라우팅 확인
<figure><figcaption>
            <h4>BGP 라우팅</h4>
        </figcaption>
</figure>
</p>
<h2 id="5-gatewayclass">5. GatewayClass</h2>
<p>GATEWAY를 사용하는 이유는 여러개의 LoadBalancer의 IP를 하나의 IP로 설정하고 Port를 사용하기 위해서다.
SVC를 생성하면 생성하는 만큼 IP가 생성이 되기때문에 IP를 공통으로 사용을 할 수 있다.</p>
<figure><figcaption>
            <h4>GATEWAYCLASS 연계</h4>
        </figcaption>
</figure>

<p>구성을 하기 위해서는 클러스터에서 servicesAPI: true 를 True로 변경 필요 및 AutoFQDN와 DefaultDomain이 필요하다.</p>
<p>위에서 언급한 AVIINFRASETTING을 한 후 GATEWAYCLASS를 생성한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.x-k8s.io/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: GatewayClass
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: critical-gwc
</span></span></span><span class="line"><span class="cl"><span class="s">spec:
</span></span></span><span class="line"><span class="cl"><span class="s">  controller: ako.vmware.com/avi-lb
</span></span></span><span class="line"><span class="cl"><span class="s">  parametersRef:
</span></span></span><span class="line"><span class="cl"><span class="s">    group: ako.vmware.com
</span></span></span><span class="line"><span class="cl"><span class="s">    kind: AviInfraSetting
</span></span></span><span class="line"><span class="cl"><span class="s">    name: other-infra
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>GATEWAY 생성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.x-k8s.io/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Gateway
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: avi-alb-gw
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: default
</span></span></span><span class="line"><span class="cl"><span class="s">spec: 
</span></span></span><span class="line"><span class="cl"><span class="s">  gatewayClassName: critical-gwc    
</span></span></span><span class="line"><span class="cl"><span class="s">  listeners: 
</span></span></span><span class="line"><span class="cl"><span class="s">  - protocol: TCP 
</span></span></span><span class="line"><span class="cl"><span class="s">    port: 8080 
</span></span></span><span class="line"><span class="cl"><span class="s">    routes: 
</span></span></span><span class="line"><span class="cl"><span class="s">      selector: 
</span></span></span><span class="line"><span class="cl"><span class="s">       matchLabels: 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-namespace: default 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-name: avi-alb-gw
</span></span></span><span class="line"><span class="cl"><span class="s">      group: v1 
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: Service
</span></span></span><span class="line"><span class="cl"><span class="s">  - protocol: TCP 
</span></span></span><span class="line"><span class="cl"><span class="s">    port: 80 
</span></span></span><span class="line"><span class="cl"><span class="s">    routes: 
</span></span></span><span class="line"><span class="cl"><span class="s">      selector: 
</span></span></span><span class="line"><span class="cl"><span class="s">       matchLabels: 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-namespace: default 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-name: avi-alb-gw
</span></span></span><span class="line"><span class="cl"><span class="s">      group: v1 
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: Service
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>만약에 LB IP를 지정 하고 싶다면. 아래와 같이 IP를 지정하면 된다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: networking.x-k8s.io/v1alpha1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Gateway
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: avi-alb-gw
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: default
</span></span></span><span class="line"><span class="cl"><span class="s">spec: 
</span></span></span><span class="line"><span class="cl"><span class="s">  gatewayClassName: critical-gwc
</span></span></span><span class="line"><span class="cl"><span class="s">  addresses:
</span></span></span><span class="line"><span class="cl"><span class="s">  - type: IPAddress
</span></span></span><span class="line"><span class="cl"><span class="s">    value: 10.253.107.203
</span></span></span><span class="line"><span class="cl"><span class="s">  listeners: 
</span></span></span><span class="line"><span class="cl"><span class="s">  - protocol: TCP 
</span></span></span><span class="line"><span class="cl"><span class="s">    port: 8080 
</span></span></span><span class="line"><span class="cl"><span class="s">    routes: 
</span></span></span><span class="line"><span class="cl"><span class="s">      selector: 
</span></span></span><span class="line"><span class="cl"><span class="s">       matchLabels: 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-namespace: default 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-name: avi-alb-gw
</span></span></span><span class="line"><span class="cl"><span class="s">      group: v1 
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: Service
</span></span></span><span class="line"><span class="cl"><span class="s">  - protocol: TCP 
</span></span></span><span class="line"><span class="cl"><span class="s">    port: 80 
</span></span></span><span class="line"><span class="cl"><span class="s">    routes: 
</span></span></span><span class="line"><span class="cl"><span class="s">      selector: 
</span></span></span><span class="line"><span class="cl"><span class="s">       matchLabels: 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-namespace: default 
</span></span></span><span class="line"><span class="cl"><span class="s">        ako.vmware.com/gateway-name: avi-alb-gw
</span></span></span><span class="line"><span class="cl"><span class="s">      group: v1 
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: Service
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>테스트</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create deploy hello --image<span class="o">=</span>paulbouwer/hello-kubernetes:1.7 --replicas<span class="o">=</span><span class="m">3</span> --port<span class="o">=</span><span class="m">8080</span>
</span></span><span class="line"><span class="cl">kubectl expose deployment hello --type<span class="o">=</span>LoadBalancer --port<span class="o">=</span><span class="m">80</span> --target-port<span class="o">=</span><span class="m">8080</span> -l <span class="s1">&#39;ako.vmware.com/gateway-namespace=default&#39;</span>,<span class="s1">&#39;ako.vmware.com/gateway-name=avi-alb-gw&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>아래와 같이 동일한 IP로 두개의 SVC를 동일한 IP로 Port(80 , 8080)만 다른게 구성 할 수 있다.
<figure><figcaption>
            <h4>VS상태#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>VS상태#2</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>VS상태#2</h4>
        </figcaption>
</figure>
</p>
]]></description>
</item><item>
    <title>The Documentation VxRail</title>
    <link>https://huntedhappy.github.io/ko/vxrail/</link>
    <pubDate>Mon, 28 Mar 2022 22:55:27 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/vxrail/</guid>
    <description><![CDATA[<p>VxRail은 전체 스택 무결성 및 포괄적인 수명주기 관리로 비즈니스 변화에 신속하게 대응하는 인프라스트럭처를 제공하여 운영 효율성을 높이고, 위험을 줄이며, 팀이 비즈니스에 집중할 수 있도록 지원합니다.</p>
<h2 id="preconfig">PreConfig</h2>
<h3 id="dns-구성">DNS 구성</h3>
<table>
<thead>
<tr>
<th>Component Name</th>
<th>BaseDomain</th>
<th>A Record</th>
</tr>
</thead>
<tbody>
<tr>
<td>vcsa01</td>
<td>vxrail.local</td>
<td>192.168.215.10</td>
</tr>
<tr>
<td>vxmgr</td>
<td>vxrail.local</td>
<td>192.168.215.9</td>
</tr>
<tr>
<td>esxi01</td>
<td>vxrail.local</td>
<td>192.168.215.11</td>
</tr>
<tr>
<td>esxi02</td>
<td>vxrail.local</td>
<td>192.168.215.12</td>
</tr>
<tr>
<td>esxi03</td>
<td>vxrail.local</td>
<td>192.168.215.13</td>
</tr>
<tr>
<td>esxi04</td>
<td>vxrail.local</td>
<td>192.168.215.14</td>
</tr>
</tbody>
</table>
<h3 id="default-passwqord">Default Passwqord</h3>
<table>
<thead>
<tr>
<th>Component Name</th>
<th>Networking Configuration</th>
<th>Username</th>
<th>Default Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIOS</td>
<td>N/A</td>
<td>192.168.215.10</td>
<td></td>
</tr>
<tr>
<td>iDRAC</td>
<td>DHCP</td>
<td>192.168.215.9</td>
<td>root</td>
</tr>
<tr>
<td>ESXi</td>
<td>DHCP</td>
<td>192.168.215.11</td>
<td>root</td>
</tr>
<tr>
<td>vCenter Server Applicance</td>
<td>root</td>
<td>vmware</td>
<td></td>
</tr>
<tr>
<td>VxRail Manager</td>
<td>192.168.10.200</td>
<td>root</td>
<td>Passw0rd!</td>
</tr>
<tr>
<td>VxRail Manager</td>
<td>192.168.10.200</td>
<td>mystic</td>
<td>VxRailManager@201602!</td>
</tr>
</tbody>
</table>
<h2 id="1-rasr을-통해-초기화">1. RASR을 통해 초기화</h2>
<p>기본적으로 VxRail장비가 입고가 되면 기본 이미지로 부팅이 되며 라이센스가 있을 경우 업그레이드를 할 수 있다.</p>
<ol>
<li>초기화를 하는 이유는 테스트 위해 60일 EVALUATION을 재사용하려면 RASR을 통해 공장 초기화를 해야 한다.</li>
<li>기존의 VxRail을 구성한 상태에서 증설을 위해 추가로 구성을 하게 될경우 기본 들어오는 버전이 낮거나 높을 수 있다. 이럴 경우 RASR을 통해 펌웨어, 이미지를 업그레이드 또는 다운그레이드를 통해 증설을 할 수 있다.</li>
<li>기본 설치되어 있는 VxRail이 테스트 하고자 하는 버전 보다 낮거나 또는 높거나 할 경우 변경을 할 수 있다.</li>
</ol>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>초기화 방법<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><blockquote>
<ol>
<li>USB</li>
</ol>
<ul>
<li>장비 모든 부분의 버전을 업그레이드 및 다운그레이가 필요 할 경우 USB 방법사용, 또한 설치가 제일 빠름</li>
</ul>
</blockquote>
<blockquote>
<ol start="2">
<li>Virtual Media</li>
</ol>
<ul>
<li>iDRAC의 Virtual Media를 통해 설치 하는 방법 부분적 설치만 가능 (Firmware 등등 업그레이드 또는 다운그레이드 못함) 또한 설치가 느림</li>
</ul>
</blockquote>
</div>
        </div>
    </div>
<p>USB를 연결 한 후 iDRAC에서 Local SD Card로 부팅
<figure><figcaption>
            <h4>USB 설치#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>USB 설치#2</h4>
        </figcaption>
</figure>
</p>
<p>Advancde 항목으로 접근 
<figure><figcaption>
            <h4>Advanced</h4>
        </figcaption>
</figure>
</p>
<p>Install DUP(s)
펌웨어 등 업그레이드 및 다운그레이드할 내용이 있는지 확인이 필요
<figure><figcaption>
            <h4>Install DUP(s)#1</h4>
        </figcaption>
</figure>
</p>
<p>업그레이드 / 다운그레이드를 선택 후 업그레이드가 있는지 다운그레이드가 있는지 체크 후 있으면 설치
<figure><figcaption>
            <h4>Install DUP(s)#2</h4>
        </figcaption>
</figure>
</p>
<p>진행 시 재부팅이 여러번 발생 대략 30분 ~ 1시간 소요
<figure><figcaption>
            <h4>Install DUP(s)#3</h4>
        </figcaption>
</figure>
</p>
<p>DUP를 업그레이드 또는 다운그레이드 이후 [F]actory Reset 실행 (1시간 소요)</p>
<h2 id="2-esxi-초기-설정">2. ESXI 초기 설정</h2>
<p><figure><figcaption>
            <h4>ESXI#1</h4>
        </figcaption>
</figure>

ESXi Shell Enable을 통해 콘솔 접속
<figure><figcaption>
            <h4>ESXI#2</h4>
        </figcaption>
</figure>

esxcli vm process list 명령어를 VxRail Manager가 보이는 호스트를 찾는다.
아무곳에서나 해도 되지만. 시간이 오래 걸린다.
<figure><figcaption>
            <h4>ESXI#3</h4>
        </figcaption>
</figure>
</p>
<p>기본 디폴트 IP는 192.168.10.200이므로 통신이 된다면 VxRail Manager VM을 켜고 접속 하면 된다. 
만약 VLAN 또는 ESXI에 접근을 하고 싶으면 명령어로 VLAN 또는 IP를 설정 할 수 있다 또는 VM을 킬 수도 있다.
여기에서는 여러가지 방법을 설명하지는 않겠다. 기본 디폴트 IP와 변경하고자 하는 IP 둘다 통신이 되면 된다.</p>
<p>여러가지 방법론이 있겠지만, 신경을 쓰고 싶지 않다면 DEFAULT IP와 변경하고자 하는 IP 둘다 통신이 되는 것으로 테스트를 하면 좋을 것이다.</p>
<p>VLAN 3939가 실제적으로 Discovery를 하는 부분으로 스위치에서 3939설정을 해주면 나중에 호스트 증설을 할때 별도로 신경을 쓰지 않아도 된다.</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>명령어<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">esxcli network vswitch standard portgroup list
</span></span><span class="line"><span class="cl">esxcli network vswitch standard portgroup <span class="nb">set</span> -p <span class="s2">&#34;Private Management Network&#34;</span> -v <span class="m">0</span>
</span></span><span class="line"><span class="cl">esxcli network ip interface list
</span></span><span class="line"><span class="cl">esxcli network ip interface ipv4 <span class="nb">set</span> -i vmk2 -I 192.168.215.13 -N 255.255.255.0 -g 192.168.215.1 -t static
</span></span></code></pre></td></tr></table>
</div>
</div><p>VxRail Manager IP 변경 방법</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vxrail-primary --setup --vxrail-address 192.168.215.9 --vxrail-netmask 255.255.255.0 --vxrail-gateway 192.168.215.1 --no-roll-back --verbose
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<h2 id="3-init">3. INIT</h2>
<p>원하는 언어를 선택 할 수 있다.
<figure><figcaption>
            <h4>INIT#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#2</h4>
        </figcaption>
</figure>
</p>
<p>Standrad Cluster (3 or more hosts)는 3개이상의 VSAN 구성
VSAN 2-Node Cluster (2 hosts only) witness host 필요
Dynamic Node Cluster (2 or more hosts) VSAN 구성이 아닌 외부 스토리지로 구성 할 경우
<figure><figcaption>
            <h4>INIT#3</h4>
        </figcaption>
</figure>

설치가 잘 되었다면 아래와 같이 자동으로 Discovery가 됨
<figure><figcaption>
            <h4>INIT#4</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#5</h4>
        </figcaption>
</figure>
</p>
<p>JSON파일로 구성이 다 되어 있다면 JSON을 삽입 해도 되지만 없으면 Step-by-step으로 진행
<figure><figcaption>
            <h4>INIT#6</h4>
        </figcaption>
</figure>
</p>
<p><figure><figcaption>
            <h4>INIT#7</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#8</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#9</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#10</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#11</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#12</h4>
        </figcaption>
</figure>
</p>
<p>나중을 위해서 JSON파일을 다운로드 받을 수 있다.
<figure><figcaption>
            <h4>INIT#13</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#14</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#15</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>INIT#16</h4>
        </figcaption>
</figure>
</p>
<h2 id="4-host-add">4. HOST ADD</h2>
<p>만약 기존 구성된 클러스터와 다른 버전이 설치되어 있는 호스트라면 RSAR 초기화 필요</p>
<p>호스트를 추가 할 때 Host DISCOVERY가 되지 않으면 loudmouth restart를 해준다.</p>
<p><figure><figcaption>
            <h4>HOST ADD#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#2</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#3</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#4</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#5</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#6</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#7</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#8</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#9</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>HOST ADD#10</h4>
        </figcaption>
</figure>
</p>
<p>HOST ADD 시 HOST가 DISCOVERY되지 않는다면 loudmouth를 리스타트 해준다.
<figure><figcaption>
            <h4>HOST ADD#11</h4>
        </figcaption>
</figure>
</p>
<h2 id="5-upgrade">5. UPGRADE</h2>
<p><figure><figcaption>
            <h4>UPGRADE#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#2</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#3</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#4</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#5</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#6</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#7</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#8</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#9</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>UPGRADE#10</h4>
        </figcaption>
</figure>
</p>
<h2 id="6-vxrail-backup">6. VxRail BackUP</h2>
<p>백업 스케줄 설정 가능</p>
<p>VxRail 접속</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## 백업 리스트 확인</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /mystic/vxm_backup_restore
</span></span><span class="line"><span class="cl">python vxm_backup_restore.py -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 메뉴얼 백업</span>
</span></span><span class="line"><span class="cl">python vxm_backup_restore.py -b
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>스케쥴 백업</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>메뉴얼 백업</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>백업 리스트 확인</h4>
        </figcaption>
</figure>
</p>
<h2 id="6-vxrail-recovery">6. VxRail Recovery</h2>
<p>VxRail Manager가 망가졌을 경우 사용 가능</p>
<p>백업이 없으면 의미 없음</p>
<p>VxRail OVA 이미지 필요</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## 신규 설치한 vxrail manager 접속 후 IP 변경</span>
</span></span><span class="line"><span class="cl">/opt/vmware/share/vami/vami_set_network eth0 STATICV4 192.168.215.9 255.255.255.0 192.168.215.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Backup 확인</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /mystic/vxm_backup_restore
</span></span><span class="line"><span class="cl">python vxm_backup_restore.py -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Recovery 실행</span>
</span></span><span class="line"><span class="cl">python vxm_backup_restore.py -r –-vcenter 192.168.215.10
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description>
</item><item>
    <title>The Documentation TAP</title>
    <link>https://huntedhappy.github.io/ko/tanzu-application-platform/</link>
    <pubDate>Wed, 09 Mar 2022 11:09:57 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/tanzu-application-platform/</guid>
    <description><![CDATA[<h2 id="1-vmware-tap">1. VMware TAP?</h2>
<p>VMware Tanzu 애플리케이션 플랫폼은 개발자와 운영자가 Kubernetes 플랫폼에서 앱을 보다 쉽게 구축, 배포 및 관리할 수 있도록 도와주는 패키지된 구성 요소 집합입니다.</p>
<p>Tanzu 애플리케이션 플랫폼은 Kubernetes 기반 앱 개발의 내부 루프와 외부 루프 모두에서 워크플로를 단순화합니다.</p>
<ul>
<li>
<p>내부 루프: 내부 루프는 개발자가 앱을 코딩하고 테스트하는 로컬 개발 환경을 설명합니다. 내부 루프에서 발생하는 활동에는 코드 작성, 버전 제어 시스템에 커밋, 개발 또는 스테이징 환경에 배포, 테스트 및 추가 코드 변경이 포함됩니다.</p>
</li>
<li>
<p>외부 루프: 외부 루프는 앱을 프로덕션에 배포하고 시간이 지남에 따라 유지 관리하는 단계를 설명합니다. 예를 들어, 클라우드 네이티브 플랫폼에서 외부 루프에는 컨테이너 이미지 빌드, 컨테이너 보안 추가, 지속적 통합(CI) 및 지속적 전달(CD) 파이프라인 구성과 같은 활동이 포함됩니다.</p>
</li>
</ul>
<p>VMware Tanzu 애플리케이션 플랫폼은 보안 및 확장을 지원하는 모든 Kubernetes에서 코드를 실행할 수 있도록 사전 포장된 프로덕션 경로를 개발 팀에 제공합니다. 팀이 조직의 기본 설정에 따라 사용자 지정할 수 있도록 모듈화된 애플리케이션 인식 플랫폼입니다.</p>
<h3 id="주의-사항">주의 사항</h3>
<p>현재 버그가 있는것으로 보임 Private Harbor 구성시 사설 인증서 문제가 발생 하기 때문에 외부 Registry 활용 필요,
Github 연동시 Integration으로 설정</p>
<h3 id="사전-설치">사전 설치</h3>
<ul>
<li>DOCKER</li>
<li>GCR (Google Container Registry)</li>
<li>GitHub</li>
<li>DNS Records</li>
</ul>
<h3 id="resource-requirements">Resource requirements</h3>
<p>To deploy all Tanzu Application Platform packages, your cluster must have at least:</p>
<ul>
<li>8 CPUs for i9 (or equivalent) available to Tanzu Application Platform components</li>
<li>12 CPUs for i7 (or equivalent) available to Tanzu Application Platform components</li>
<li>8 GB of RAM across all nodes available to Tanzu Application Platform</li>
<li>12 GB of RAM is available to build and deploy applications, including Minikube. VMware recommends 16 GB of RAM for an optimal experience.</li>
<li>70 GB of disk space available per node
For the full profile, or use of Security Chain Security Tools - Store, your cluster must have a configured default StorageClass.</li>
</ul>
<h2 id="2-tap-101">2. TAP 1.0.1</h2>
<h3 id="tools-and-cli-requirements">Tools and CLI requirements</h3>
<p>Installation requires:</p>
<ul>
<li>The Kubernetes CLI, kubectl, v1.20, v1.21 or v1.22, installed and authenticated with administrator rights for your target cluster. See Install Tools in the Kubernetes documentation.</li>
</ul>
<h3 id="21-tap">2.1. TAP</h3>
<h4 id="211-tanzu-network-등록">2.1.1 Tanzu Network 등록</h4>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Tanzu Network ID/PW<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">INSTALL_REGISTRY_USERNAME</span><span class="o">=</span>        <span class="c1">#### Tanzu Network ID</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">INSTALL_REGISTRY_PASSWORD</span><span class="o">=</span>        <span class="c1">#### Tanzu Network PW</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="o">=</span>registry.tanzu.vmware.com
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TAP_VERSION</span><span class="o">=</span>1.0.1
</span></span></code></pre></td></tr></table>
</div>
</div><p>namespace 생성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create ns tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><p>tanzu registry 추가</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu secret registry add tap-registry <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --username <span class="si">${</span><span class="nv">INSTALL_REGISTRY_USERNAME</span><span class="si">}</span> --password <span class="si">${</span><span class="nv">INSTALL_REGISTRY_PASSWORD</span><span class="si">}</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --server <span class="si">${</span><span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="si">}</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --export-to-all-namespaces --yes --namespace tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><p>tanzu repository 추가</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu package repository add tanzu-tap-repository <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --url registry.tanzu.vmware.com/tanzu-application-platform/tap-packages:<span class="nv">$TAP_VERSION</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --namespace tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p><figure><figcaption>
            <h4>EULA 허용</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>EULA 허용</h4>
        </figcaption>
</figure>
</p>
<h3 id="22-tanzu-tap-설치-리스트-확인">2.2. Tanzu TAP 설치 리스트 확인</h3>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Registry / Repository 확인<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu secret registry list -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package repository list -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package repository get tanzu-tap-repository --namespace tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package available list --namespace tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package available list tap.tanzu.vmware.com --namespace tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p><figure><figcaption>
            <h4>Registry 리스트 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Repository 리스트 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>Package 리스트 확인</h4>
        </figcaption>
</figure>
</p>
<h3 id="23-tanzu-tap-설치">2.3. Tanzu TAP 설치</h3>
<p>Private Harbor의 경우 사설 인증서가 문제가 있으므로 외부에서 제공하는 Registry 사용하는 필요.</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>TAP 설치<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>GCR에서 키값을 json으로 다운로드 받은 후 service_account_key[변수] 저장</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu secret registry add registry-credentials --server gcr.io --username _json_key --password <span class="s2">&#34;</span><span class="k">$(</span>cat main-xxxx-xxx-xxxx.json<span class="k">)</span><span class="s2">&#34;</span> --namespace tap-install
</span></span><span class="line"><span class="cl"><span class="nv">service_account_key</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>cat main-xxxx-xxx-xxxx.json<span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>실행 파일 설정</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF &gt; gcr-tap-values.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">profile: full
</span></span></span><span class="line"><span class="cl"><span class="s">ceip_policy_disclosed: true # The value must be true for installation to succeed
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">buildservice:
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository: &#34;gcr.io/{Registry ID}/build-service&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository_username: _json_key
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository_password: &#39;$(echo $service_account_key)&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">  tanzunet_username: &#34;&#34;                             ## Tanzu Network ID
</span></span></span><span class="line"><span class="cl"><span class="s">  tanzunet_password: &#34;&#34;                             ## Tanzu Network Password
</span></span></span><span class="line"><span class="cl"><span class="s">  descriptor_name: &#34;tap-1.0.0-full&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  enable_automatic_dependency_updates: true
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">supply_chain: basic
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">cnrs:
</span></span></span><span class="line"><span class="cl"><span class="s">  domain_name: tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">accelerator:
</span></span></span><span class="line"><span class="cl"><span class="s">  server:
</span></span></span><span class="line"><span class="cl"><span class="s">    service_type: &#34;ClusterIP&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">ootb_supply_chain_basic:
</span></span></span><span class="line"><span class="cl"><span class="s">  registry:
</span></span></span><span class="line"><span class="cl"><span class="s">    server: &#34;gcr.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    repository: &#34;{Registry ID}/supply_chain&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  gitops:
</span></span></span><span class="line"><span class="cl"><span class="s">    #repository_prefix: git@github.com:vmware-tanzu/
</span></span></span><span class="line"><span class="cl"><span class="s">    #branch: main
</span></span></span><span class="line"><span class="cl"><span class="s">    #user_name: supplychain
</span></span></span><span class="line"><span class="cl"><span class="s">    #user_email: supplychain
</span></span></span><span class="line"><span class="cl"><span class="s">    #commit_message: supplychain@cluster.local
</span></span></span><span class="line"><span class="cl"><span class="s">    #ssh_secret: git-ssh  
</span></span></span><span class="line"><span class="cl"><span class="s">    ssh_secret: &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  cluster_builder: default
</span></span></span><span class="line"><span class="cl"><span class="s">  service_account: default
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">learningcenter:
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: &#34;tkg.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressClass: contour
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressSecret:
</span></span></span><span class="line"><span class="cl"><span class="s">    secretName: workshops.example.com-tls
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">contour:
</span></span></span><span class="line"><span class="cl"><span class="s">  envoy:
</span></span></span><span class="line"><span class="cl"><span class="s">    service:
</span></span></span><span class="line"><span class="cl"><span class="s">      type: LoadBalancer
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">tap_gui:
</span></span></span><span class="line"><span class="cl"><span class="s">  service_type: ClusterIP
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressEnabled: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: &#34;tkg.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  app_config:
</span></span></span><span class="line"><span class="cl"><span class="s">    app:
</span></span></span><span class="line"><span class="cl"><span class="s">      baseUrl: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">      support:
</span></span></span><span class="line"><span class="cl"><span class="s">        url: https://tanzu.vmware.com/support
</span></span></span><span class="line"><span class="cl"><span class="s">        items:
</span></span></span><span class="line"><span class="cl"><span class="s">          - title: Contact Support
</span></span></span><span class="line"><span class="cl"><span class="s">            icon: email
</span></span></span><span class="line"><span class="cl"><span class="s">            links:
</span></span></span><span class="line"><span class="cl"><span class="s">              - url: https://tanzu.vmware.com/support
</span></span></span><span class="line"><span class="cl"><span class="s">                title: Tanzu Support Page
</span></span></span><span class="line"><span class="cl"><span class="s">          - title: Documentation
</span></span></span><span class="line"><span class="cl"><span class="s">            icon: docs
</span></span></span><span class="line"><span class="cl"><span class="s">            links:
</span></span></span><span class="line"><span class="cl"><span class="s">              - url: https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/index.html
</span></span></span><span class="line"><span class="cl"><span class="s">                title: Tanzu Application Platform Documentation
</span></span></span><span class="line"><span class="cl"><span class="s">    integrations:
</span></span></span><span class="line"><span class="cl"><span class="s">      github: # Other integrations available see NOTE below
</span></span></span><span class="line"><span class="cl"><span class="s">        - host: github.com
</span></span></span><span class="line"><span class="cl"><span class="s">          token: &#34;{GIT TOKEN}&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    catalog:
</span></span></span><span class="line"><span class="cl"><span class="s">      locations:
</span></span></span><span class="line"><span class="cl"><span class="s">        - type: url
</span></span></span><span class="line"><span class="cl"><span class="s">          target: https://github.com/huntedhappy/tanzu-java-web-app/catalog-info.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    backend:
</span></span></span><span class="line"><span class="cl"><span class="s">      baseUrl: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">      cors:
</span></span></span><span class="line"><span class="cl"><span class="s">        origin: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">#    ##Existing values file above (OIDC)
</span></span></span><span class="line"><span class="cl"><span class="s">#    auth:
</span></span></span><span class="line"><span class="cl"><span class="s">#      allowGuestAccess: true
</span></span></span><span class="line"><span class="cl"><span class="s">#      environment: development
</span></span></span><span class="line"><span class="cl"><span class="s">#      loginPage:
</span></span></span><span class="line"><span class="cl"><span class="s">#        github:
</span></span></span><span class="line"><span class="cl"><span class="s">#          title: Github Login
</span></span></span><span class="line"><span class="cl"><span class="s">#          message: Enter with your GitHub account
</span></span></span><span class="line"><span class="cl"><span class="s">#      providers:
</span></span></span><span class="line"><span class="cl"><span class="s">#        github:
</span></span></span><span class="line"><span class="cl"><span class="s">#          development:
</span></span></span><span class="line"><span class="cl"><span class="s">#            clientId: 
</span></span></span><span class="line"><span class="cl"><span class="s">#            clientSecret: 
</span></span></span><span class="line"><span class="cl"><span class="s">#            ## uncomment if using GitHub Enterprise
</span></span></span><span class="line"><span class="cl"><span class="s">#            # enterpriseInstanceUrl:
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">metadata_store:
</span></span></span><span class="line"><span class="cl"><span class="s">  app_service_type: LoadBalancer # (optional) Defaults to LoadBalancer. Change to NodePort for distributions that don&#39;t support LoadBalancer
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">grype:
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: &#34;tap-install&#34; # (optional) Defaults to default namespace.
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>TAP 설치</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v <span class="nv">$TAP_VERSION</span> --values-file gcr-tap-values.yml -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<figure><figcaption>
            <h4>TAP 설치 완료</h4>
        </figcaption>
</figure>

<h3 id="24-tanzu-tap-rbac-설정">2.4. Tanzu TAP RBAC 설정</h3>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>RBAC 설정<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">dockerconfigjson</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>kubectl get secret tbs-builder-secret-gen-placeholder-secret -n tap-install -o <span class="nv">jsonpath</span><span class="o">={</span>.data.<span class="se">\\</span>.dockerconfigjson<span class="o">}</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF | tee rbac.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Secret
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-registry
</span></span></span><span class="line"><span class="cl"><span class="s">  annotations:
</span></span></span><span class="line"><span class="cl"><span class="s">    secretgen.carvel.dev/image-pull-secret: &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">type: kubernetes.io/dockerconfigjson
</span></span></span><span class="line"><span class="cl"><span class="s">data:
</span></span></span><span class="line"><span class="cl"><span class="s">  .dockerconfigjson: $(echo $dockerconfigjson)
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default
</span></span></span><span class="line"><span class="cl"><span class="s">secrets:
</span></span></span><span class="line"><span class="cl"><span class="s">  - name: registry-credentials
</span></span></span><span class="line"><span class="cl"><span class="s">imagePullSecrets:
</span></span></span><span class="line"><span class="cl"><span class="s">  - name: registry-credentials
</span></span></span><span class="line"><span class="cl"><span class="s">  - name: tap-registry
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Role
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default
</span></span></span><span class="line"><span class="cl"><span class="s">rules:
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [source.toolkit.fluxcd.io]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [gitrepositories]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [source.apps.tanzu.vmware.com]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [imagerepositories]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [carto.run]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [deliverables, runnables]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [kpack.io]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [images]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [conventions.apps.tanzu.vmware.com]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [podintents]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#34;&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;configmaps&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#34;&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;pods&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [tekton.dev]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [taskruns, pipelineruns]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [tekton.dev]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [pipelines]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [kappctrl.k14s.io]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [apps]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [serving.knative.dev]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;services&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [servicebinding.io]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;servicebindings&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [services.apps.tanzu.vmware.com]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;resourceclaims&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [scanning.apps.tanzu.vmware.com]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;imagescans&#39;, &#39;sourcescans&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;*&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: Role
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<h3 id="25-workload-실행">2.5. workload 실행</h3>
<p>INGRESS IP 확인</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get svc -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get httpproxy -A
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>ingress 및 DNS 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>gui 접속 후 Tanzu Java Web App 실행</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>gui 접속 후 Tanzu Java Web App 실행</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>gui 접속 후 Tanzu Java Web App 실행</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>gui 접속 후 Tanzu Java Web App 다운로드</h4>
        </figcaption>
</figure>
</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>GIT PUSH<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>미리 GIT에 프로젝트 생성 후 다운로드 받은 ZIP파일 PUSH</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">unzip tanzu-java-web-app.zip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git init
</span></span><span class="line"><span class="cl">git remote add origin git@github.com:huntedhappy/tanzu-java-web-app
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s1">&#39;first&#39;</span>
</span></span><span class="line"><span class="cl">git push origin main
</span></span></code></pre></td></tr></table>
</div>
</div><p>apps workload 실행</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu apps workload create tanzu-java-web-app <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --git-repo https://github.com/huntedhappy/tanzu-java-web-app <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --git-branch main <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --type web <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --label apps.tanzu.vmware.com/has-tests<span class="o">=</span><span class="nb">true</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --yes <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><p>배포 상태 확인</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu apps cluster-supply-chain list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu apps workload tail tanzu-java-web-app --since 10m --timestamp -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl get workload,gitrepository,pipelinerun,images.kpack,podintent,app,services.serving -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<h2 id="3-tap-110">3. TAP 1.1.0</h2>
<p>Repository를 설정한다. 여기서는 GCR을 사용하기 때문에 GCR의 정보를 입력</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="o">=</span>gcr.io
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TAP_VERSION</span><span class="o">=</span>1.1.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>TANZU NET 및 GCR docker login 후 GCR에 이미지들을 다운로드</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker login registry.tanzu.vmware.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker login -u _json_key --password-stdin https://gcr.io &lt; <span class="o">{</span>gcr key<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">imgpkg copy -b registry.tanzu.vmware.com/tanzu-application-platform/tap-packages:<span class="si">${</span><span class="nv">TAP_VERSION</span><span class="si">}</span> --to-repo <span class="si">${</span><span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="si">}</span>/<span class="o">{</span>gcr project<span class="o">}</span>/tap-packages
</span></span></code></pre></td></tr></table>
</div>
</div><p>namespace 및 secret 생성 후 tanzu package Repository 생성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu secret registry add tap-registry --server gcr.io --username _json_key --password <span class="s2">&#34;</span><span class="k">$(</span>cat <span class="o">{</span>gcr key<span class="o">}</span><span class="k">)</span><span class="s2">&#34;</span> --export-to-all-namespaces --yes -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu secret registry add registry-credentials --server gcr.io --username _json_key --password <span class="s2">&#34;</span><span class="k">$(</span>cat <span class="o">{</span>gcr key<span class="o">}</span><span class="k">)</span><span class="s2">&#34;</span> --export-to-all-namespaces --yes -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package repository add tanzu-tap-repository <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --url <span class="si">${</span><span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="si">}</span>/main-tokenizer-343509/tap-packages:<span class="nv">$TAP_VERSION</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --namespace tap-install 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Repository가 생성이 되었으면 설치 가능한 packages를 확인</span>
</span></span><span class="line"><span class="cl">tanzu package available list tap.tanzu.vmware.com --namespace tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><p>권한 설정</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl annotate secret tap-registry -n tap-install secretgen.carvel.dev/image-pull-secret<span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl patch sa default -n tap-install --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;add&#34;,&#34;path&#34;:&#34;/secrets&#34;,&#34;value&#34;:[&#34;name&#34;:&#34;registry-credentials&#34;,&#34;name&#34;:&#34;tap-registry&#34;]}]&#39;</span>
</span></span><span class="line"><span class="cl">kubectl patch sa default -n tap-install --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;add&#34;,&#34;path&#34;:&#34;/imagePullSecrets&#34;,&#34;value&#34;:[&#34;name&#34;:&#34;registry-credentials&#34;,&#34;name&#34;:&#34;tap-registry&#34;]}]&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF | kubectl -n tap-install apply -f -
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default-permit-deliverable
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: deliverable
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default-permit-workload
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: workload
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: dev-permit-app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: Group
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#34;namespace-developers&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: namespace-dev-permit-app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: app-viewer-cluster-access
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: Group
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#34;namespace-developers&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>TAP 1.1.0 설치</p>
<p>GCR에서 키값을 json으로 다운로드 받은 후 service_account_key[변수] 저장</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu secret registry add registry-credentials --server gcr.io --username _json_key --password <span class="s2">&#34;</span><span class="k">$(</span>cat main-xxxx-xxx-xxxx.json<span class="k">)</span><span class="s2">&#34;</span> --namespace tap-install
</span></span><span class="line"><span class="cl"><span class="nv">service_account_key</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>cat main-xxxx-xxx-xxxx.json<span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>실행 파일 설정</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF &gt; gcr-tap-values.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">profile: full
</span></span></span><span class="line"><span class="cl"><span class="s">ceip_policy_disclosed: true # The value must be true for installation to succeed
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">buildservice:
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository: &#34;gcr.io/{Registry ID}/build-service&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository_username: _json_key
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository_password: &#39;$(echo $service_account_key)&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">  tanzunet_username: &#34;&#34;                             ## Tanzu Network ID
</span></span></span><span class="line"><span class="cl"><span class="s">  tanzunet_password: &#34;&#34;                             ## Tanzu Network Password
</span></span></span><span class="line"><span class="cl"><span class="s">  descriptor_name: &#34;full&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  enable_automatic_dependency_updates: true
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">supply_chain: basic
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">cnrs:
</span></span></span><span class="line"><span class="cl"><span class="s">  domain_name: tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">accelerator:
</span></span></span><span class="line"><span class="cl"><span class="s">  server:
</span></span></span><span class="line"><span class="cl"><span class="s">    service_type: &#34;ClusterIP&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">ootb_supply_chain_basic:
</span></span></span><span class="line"><span class="cl"><span class="s">  registry:
</span></span></span><span class="line"><span class="cl"><span class="s">    server: &#34;gcr.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    repository: &#34;{Registry ID}/supply_chain&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  gitops:
</span></span></span><span class="line"><span class="cl"><span class="s">    #repository_prefix: git@github.com:vmware-tanzu/
</span></span></span><span class="line"><span class="cl"><span class="s">    #branch: main
</span></span></span><span class="line"><span class="cl"><span class="s">    #user_name: supplychain
</span></span></span><span class="line"><span class="cl"><span class="s">    #user_email: supplychain
</span></span></span><span class="line"><span class="cl"><span class="s">    #commit_message: supplychain@cluster.local
</span></span></span><span class="line"><span class="cl"><span class="s">    #ssh_secret: git-ssh  
</span></span></span><span class="line"><span class="cl"><span class="s">    ssh_secret: &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  cluster_builder: default
</span></span></span><span class="line"><span class="cl"><span class="s">  service_account: default
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">learningcenter:
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: &#34;tkg.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressClass: contour
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressSecret:
</span></span></span><span class="line"><span class="cl"><span class="s">    secretName: workshops.example.com-tls
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">contour:
</span></span></span><span class="line"><span class="cl"><span class="s">  envoy:
</span></span></span><span class="line"><span class="cl"><span class="s">    service:
</span></span></span><span class="line"><span class="cl"><span class="s">      type: LoadBalancer
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">tap_gui:
</span></span></span><span class="line"><span class="cl"><span class="s">  service_type: ClusterIP
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressEnabled: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: &#34;tkg.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  app_config:
</span></span></span><span class="line"><span class="cl"><span class="s">    app:
</span></span></span><span class="line"><span class="cl"><span class="s">      baseUrl: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">      support:
</span></span></span><span class="line"><span class="cl"><span class="s">        url: https://tanzu.vmware.com/support
</span></span></span><span class="line"><span class="cl"><span class="s">        items:
</span></span></span><span class="line"><span class="cl"><span class="s">          - title: Contact Support
</span></span></span><span class="line"><span class="cl"><span class="s">            icon: email
</span></span></span><span class="line"><span class="cl"><span class="s">            links:
</span></span></span><span class="line"><span class="cl"><span class="s">              - url: https://tanzu.vmware.com/support
</span></span></span><span class="line"><span class="cl"><span class="s">                title: Tanzu Support Page
</span></span></span><span class="line"><span class="cl"><span class="s">          - title: Documentation
</span></span></span><span class="line"><span class="cl"><span class="s">            icon: docs
</span></span></span><span class="line"><span class="cl"><span class="s">            links:
</span></span></span><span class="line"><span class="cl"><span class="s">              - url: https://docs.vmware.com/en/VMware-Tanzu-Application-Platform/index.html
</span></span></span><span class="line"><span class="cl"><span class="s">                title: Tanzu Application Platform Documentation
</span></span></span><span class="line"><span class="cl"><span class="s">    integrations:
</span></span></span><span class="line"><span class="cl"><span class="s">      github: # Other integrations available see NOTE below
</span></span></span><span class="line"><span class="cl"><span class="s">        - host: github.com
</span></span></span><span class="line"><span class="cl"><span class="s">          token: &#34;{GIT TOKEN}&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    catalog:
</span></span></span><span class="line"><span class="cl"><span class="s">      locations:
</span></span></span><span class="line"><span class="cl"><span class="s">        - type: url
</span></span></span><span class="line"><span class="cl"><span class="s">          target: https://github.com/huntedhappy/tanzu-java-web-app/catalog-info.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    backend:
</span></span></span><span class="line"><span class="cl"><span class="s">      baseUrl: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">      cors:
</span></span></span><span class="line"><span class="cl"><span class="s">        origin: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">#    ##Existing values file above (OIDC)
</span></span></span><span class="line"><span class="cl"><span class="s">#    auth:
</span></span></span><span class="line"><span class="cl"><span class="s">#      allowGuestAccess: true
</span></span></span><span class="line"><span class="cl"><span class="s">#      environment: development
</span></span></span><span class="line"><span class="cl"><span class="s">#      loginPage:
</span></span></span><span class="line"><span class="cl"><span class="s">#        github:
</span></span></span><span class="line"><span class="cl"><span class="s">#          title: Github Login
</span></span></span><span class="line"><span class="cl"><span class="s">#          message: Enter with your GitHub account
</span></span></span><span class="line"><span class="cl"><span class="s">#      providers:
</span></span></span><span class="line"><span class="cl"><span class="s">#        github:
</span></span></span><span class="line"><span class="cl"><span class="s">#          development:
</span></span></span><span class="line"><span class="cl"><span class="s">#            clientId: 
</span></span></span><span class="line"><span class="cl"><span class="s">#            clientSecret: 
</span></span></span><span class="line"><span class="cl"><span class="s">#            ## uncomment if using GitHub Enterprise
</span></span></span><span class="line"><span class="cl"><span class="s">#            # enterpriseInstanceUrl:
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">metadata_store:
</span></span></span><span class="line"><span class="cl"><span class="s">  app_service_type: LoadBalancer # (optional) Defaults to LoadBalancer. Change to NodePort for distributions that don&#39;t support LoadBalancer
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">grype:
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: &#34;tap-install&#34; # (optional) Defaults to default namespace.
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>TANZU 설치</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v <span class="nv">$TAP_VERSION</span> --values-file gcr-tap-values.yaml -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="31-multicluster">3.1. MultiCluster</h3>
<figure><figcaption>
            <h4>MultiCluster</h4>
        </figcaption>
</figure>

<p>3개의 클러스터를 생성한다. 여기서는 아래와 같이 구성 하였다.</p>
<ul>
<li>
<p>tkgm01-tkc-dev02 = build</p>
</li>
<li>
<p>tkgm02-tkc-dev03 = run</p>
</li>
<li>
<p>tkgm03-tkc-dev04 = view</p>
</li>
</ul>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>이미지를 Repository에 저장한다.<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="o">=</span>gcr.io
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TAP_VERSION</span><span class="o">=</span>1.1.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Tanzu Network에 로그인을 한다.</span>
</span></span><span class="line"><span class="cl">docker login registry.tanzu.vmware.com -u <span class="o">{</span>ID<span class="o">}</span> --password-stdin &lt; ./password.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## GCR에 로그인을 한다.</span>
</span></span><span class="line"><span class="cl">docker login -u _json_key --password-stdin https://gcr.io &lt; <span class="o">{</span>togken<span class="o">}}</span>.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 이미지를 GCR에 복사 한다.</span>
</span></span><span class="line"><span class="cl">imgpkg copy -b registry.tanzu.vmware.com/tanzu-application-platform/tap-packages:<span class="si">${</span><span class="nv">TAP_VERSION</span><span class="si">}</span> --to-repo <span class="si">${</span><span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="si">}</span>/main-tokenizer-343509/tap-packages
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>모든 이미지가 GCR에 저장이 완료 되면 Repository를 각각의 클러스터에 등록 해준다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## Cluster 변경</span>
</span></span><span class="line"><span class="cl">kubectl use-context <span class="o">{</span>cluster context<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">## NameSpace 생성</span>
</span></span><span class="line"><span class="cl">kubectl create ns tap-install
</span></span><span class="line"><span class="cl"><span class="c1">## GCR 접속 Secret 생성</span>
</span></span><span class="line"><span class="cl">tanzu secret registry add tap-registry --server gcr.io --username _json_key --password <span class="s2">&#34;</span><span class="k">$(</span>cat <span class="o">{</span>gcr-key<span class="o">}</span>.json<span class="k">)</span><span class="s2">&#34;</span>  --export-to-all-namespaces --yes -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu secret registry add registry-credentials --server gcr.io --username _json_key --password <span class="s2">&#34;</span><span class="k">$(</span>cat <span class="o">{</span>gcr-key<span class="o">}</span>.json<span class="k">)</span><span class="s2">&#34;</span> --export-to-all-namespaces --yes -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Tanzu Package Repository 추가</span>
</span></span><span class="line"><span class="cl">tanzu package repository add tanzu-tap-repository <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --url <span class="si">${</span><span class="nv">INSTALL_REGISTRY_HOSTNAME</span><span class="si">}</span>/main-tokenizer-343509/tap-packages:<span class="nv">$TAP_VERSION</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --namespace tap-install 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Tanzu Package Repository 확인</span>
</span></span><span class="line"><span class="cl">tanzu package repository list -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>각각의 클러스터의 맞는 tap을 설치 해준다.</li>
<li>build-tap-values.yaml</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | tee build-tap-values.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">profile: build
</span></span></span><span class="line"><span class="cl"><span class="s">ceip_policy_disclosed: true
</span></span></span><span class="line"><span class="cl"><span class="s">buildservice:
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository: &#34;gcr.io/{gcr project}/tap-packages&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository_username: _json_key
</span></span></span><span class="line"><span class="cl"><span class="s">  kp_default_repository_password: {gcr key}
</span></span></span><span class="line"><span class="cl"><span class="s">  tanzunet_username: &#34;&#34;                             ## Tanzu Network ID
</span></span></span><span class="line"><span class="cl"><span class="s">  tanzunet_password: &#34;&#34;                                     ## Tanzu Network Password
</span></span></span><span class="line"><span class="cl"><span class="s">  descriptor_name: &#34;full&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  enable_automatic_dependency_updates: true
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">supply_chain: basic
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">ootb_supply_chain_basic:
</span></span></span><span class="line"><span class="cl"><span class="s">  registry:
</span></span></span><span class="line"><span class="cl"><span class="s">    server: &#34;gcr.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    repository: &#34;{gcr project}/supply_chain&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  gitops:
</span></span></span><span class="line"><span class="cl"><span class="s">    ssh_secret: &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  cluster_builder: default
</span></span></span><span class="line"><span class="cl"><span class="s">  service_account: default
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">grype:
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: &#34;tap-install&#34; # (optional) Defaults to default namespace.
</span></span></span><span class="line"><span class="cl"><span class="s">  targetImagePullSecret: tap-registry
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>run-tap-values.yaml</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | tee run-tap-values.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">profile: run
</span></span></span><span class="line"><span class="cl"><span class="s">ceip_policy_disclosed: true # Installation fails if this is not set to true. Not a string.
</span></span></span><span class="line"><span class="cl"><span class="s">supply_chain: basic
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">cnrs:
</span></span></span><span class="line"><span class="cl"><span class="s">  domain_name: tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">contour:
</span></span></span><span class="line"><span class="cl"><span class="s">  envoy:
</span></span></span><span class="line"><span class="cl"><span class="s">    service:
</span></span></span><span class="line"><span class="cl"><span class="s">      type: LoadBalancer #NodePort can be used if your Kubernetes cluster doesn&#39;t support LoadBalancing
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">appliveview_connector:
</span></span></span><span class="line"><span class="cl"><span class="s">  backend:
</span></span></span><span class="line"><span class="cl"><span class="s">    sslDisabled: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    host: appliveview.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>클러스터를 변경 하면서 TAP을 설치 해준다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl use-context <span class="o">{</span>TAP 클러스터<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v 1.1.0 -f build-tap-values.yaml -n tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v 1.1.0 -f run-tap-values.yaml -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>build 와 run 클러스터에 TAP 설치가 완료 되었다면 클러스터의 URL 과 TOKEN을 확인한다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">CLUSTER_URL</span><span class="o">=</span><span class="k">$(</span>kubectl config view --minify -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.clusters[0].cluster.server}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">CLUSTER_TOKEN</span><span class="o">=</span><span class="k">$(</span>kubectl -n tap-gui get secret <span class="k">$(</span>kubectl -n tap-gui get sa tap-gui-viewer -o<span class="o">=</span>json <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> jq -r <span class="s1">&#39;.secrets[0].name&#39;</span><span class="k">)</span> -o<span class="o">=</span>json <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> jq -r <span class="s1">&#39;.data[&#34;token&#34;]&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> base64 --decode<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> CLUSTER_URL: <span class="nv">$CLUSTER_URL</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> CLUSTER_TOKEN: <span class="nv">$CLUSTER_TOKEN</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>view-tap-values.yaml</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | tee view-tap-values.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">profile: view
</span></span></span><span class="line"><span class="cl"><span class="s">ceip_policy_disclosed: true # Installation fails if this is not set to true. Not a string.
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">contour:
</span></span></span><span class="line"><span class="cl"><span class="s">  envoy:
</span></span></span><span class="line"><span class="cl"><span class="s">    service:
</span></span></span><span class="line"><span class="cl"><span class="s">      type: LoadBalancer #NodePort can be used if your Kubernetes cluster doesn&#39;t support LoadBalancing
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">learningcenter:
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: &#34;tkg.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">tap_gui:
</span></span></span><span class="line"><span class="cl"><span class="s">  service_type: ClusterIP
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressEnabled: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: &#34;tkg.io&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  app_config:
</span></span></span><span class="line"><span class="cl"><span class="s">    app:
</span></span></span><span class="line"><span class="cl"><span class="s">      baseUrl: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">    catalog:
</span></span></span><span class="line"><span class="cl"><span class="s">      locations:
</span></span></span><span class="line"><span class="cl"><span class="s">        - type: url
</span></span></span><span class="line"><span class="cl"><span class="s">          target: https://GIT-CATALOG-URL/catalog-info.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">    backend:
</span></span></span><span class="line"><span class="cl"><span class="s">      baseUrl: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">      cors:
</span></span></span><span class="line"><span class="cl"><span class="s">        origin: http://tap-gui.tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">    kubernetes:
</span></span></span><span class="line"><span class="cl"><span class="s">      serviceLocatorMethod:
</span></span></span><span class="line"><span class="cl"><span class="s">        type: &#39;multiTenant&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">      clusterLocatorMethods:
</span></span></span><span class="line"><span class="cl"><span class="s">        - type: &#39;config&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">          clusters:
</span></span></span><span class="line"><span class="cl"><span class="s">            - url: https://10.253.125.252:6443
</span></span></span><span class="line"><span class="cl"><span class="s">              name: tkgm01-tkc-dev02
</span></span></span><span class="line"><span class="cl"><span class="s">              authProvider: serviceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">              skipTLSVerify: true
</span></span></span><span class="line"><span class="cl"><span class="s">              serviceAccountToken: eyJhbGciOiJSUzI1NiIsImtpZCI6InZ4S25KYi1SVW96UmJmdnVXc2lSODlza1NTV0RBRkd1aG1acHI5Qy0xdjAifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ0YXAtZ3VpIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InRhcC1ndWktdmlld2VyLXRva2VuLTk1c3EyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6InRhcC1ndWktdmlld2VyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNzJhOTY2ZGEtYzA2ZS00OTIyLTk5Y2YtM2ZjYTMwNmNkNWM5Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OnRhcC1ndWk6dGFwLWd1aS12aWV3ZXIifQ.Vit66qxirDMNcZlUHaDaNXJAWpU-J0o5wfBXK8U2kVnoP3RMcAGrSTodoZ3fnsNtTlPKSCMlw9I7m591Kcly1HL8CPLwkLH-P2Ew26eurQHvVb-NGQUFAIRSdrN6Ig6J5Xg09D5D8wGMJTk7egSud8cj5A1z1bT1ctLCX1N2WrqO3Hrcu0o8XHgSoiogTP_ELU8B2E93kHqdCPeh0xbY9pkTEvXRQun9PTeag6jepd7eNUgCXMab4jYxsEXDbJ3PPbDusuleY2LpcObYaWuuYMyRc5QSVG5EBlEKfaXnEvslTNxdohdEQwQOHwABKC4Au-KBYbzy2s_MI40g2K79iw
</span></span></span><span class="line"><span class="cl"><span class="s">            - url: https://10.253.125.253:6443
</span></span></span><span class="line"><span class="cl"><span class="s">              name: tkgm01-tkc-dev03
</span></span></span><span class="line"><span class="cl"><span class="s">              authProvider: serviceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">              skipTLSVerify: true
</span></span></span><span class="line"><span class="cl"><span class="s">              serviceAccountToken: eyJhbGciOiJSUzI1NiIsImtpZCI6Ii0tYzNpVm9HbXdfTkxqREZhU1ZXeEY0RXJCY29Sc0lwWkl5WW9XdENsYzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ0YXAtZ3VpIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InRhcC1ndWktdmlld2VyLXRva2VuLWs0aHQ2Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6InRhcC1ndWktdmlld2VyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNTBiNjMxYjktYjRlOS00ZjhhLThmZDgtNDAwMDE3ZWZkOTJmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OnRhcC1ndWk6dGFwLWd1aS12aWV3ZXIifQ.DL4nTskvqSvEXwi0HN2rNk61UD3DquvCnRxrFZZT2cM7L7WznTlqdXFxXsqlabE9zcS3nTLQ2NWDjx2qrJEdiAzqr6rOGXkFzYeyuE9kvzcTnVbHYYlagA8UMCjeQUAw0DtTGip3UFqPoXUGdwlZHYR7e1VQcaSmdnFc0UVTrDlpDdGQgJujDvyiU18-pa7BeizBkPJbKPVOgn0sP5M_zZh5Rtzb4-PKc1pYiAG7lg_05U7w_5rfMeoaLFN0H36BKUpGHb7inakGjnR3Z7_6iPe7x4FUR4zK-WZFCT4LbckfR0NKaDGHCaGoMSqQ-W2j6GFdK1wRVGhnortD8mC4ww
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">metadata_store:
</span></span></span><span class="line"><span class="cl"><span class="s">  app_service_type: LoadBalancer # (optional) Defaults to LoadBalancer. Change to NodePort for distributions that don&#39;t support LoadBalancer
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">appliveview:
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressEnabled: &#34;true&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">  ingressDomain: tkg.io
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>view 클러스터에 TAP 설치</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu package install tap -p tap.tanzu.vmware.com -v 1.1.0 -f view-tap-values.yaml -n tap-install
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>설치 완료 후 build 와 run cluster에 권한 부여</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f - <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: Namespace
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-read-k8s
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">- kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">  namespace: tap-gui
</span></span></span><span class="line"><span class="cl"><span class="s">  name: tap-gui-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: k8s-reader
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: k8s-reader
</span></span></span><span class="line"><span class="cl"><span class="s">rules:
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;pods&#39;, &#39;services&#39;, &#39;configmaps&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;apps&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;deployments&#39;, &#39;replicasets&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;autoscaling&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;horizontalpodautoscalers&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;networking.k8s.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;ingresses&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;networking.internal.knative.dev&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [&#39;serverlessservices&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [ &#39;autoscaling.internal.knative.dev&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources: [ &#39;podautoscalers&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [ &#39;get&#39;, &#39;watch&#39;, &#39;list&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;serving.knative.dev&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - configurations
</span></span></span><span class="line"><span class="cl"><span class="s">  - revisions
</span></span></span><span class="line"><span class="cl"><span class="s">  - routes
</span></span></span><span class="line"><span class="cl"><span class="s">  - services
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;carto.run&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterconfigtemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterdeliveries
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterdeploymenttemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterimagetemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clusterruntemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clustersourcetemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - clustersupplychains
</span></span></span><span class="line"><span class="cl"><span class="s">  - clustertemplates
</span></span></span><span class="line"><span class="cl"><span class="s">  - deliverables
</span></span></span><span class="line"><span class="cl"><span class="s">  - runnables
</span></span></span><span class="line"><span class="cl"><span class="s">  - workloads
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;source.toolkit.fluxcd.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - gitrepositories
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;source.apps.tanzu.vmware.com&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - imagerepositories
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;conventions.apps.tanzu.vmware.com&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - podintents
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;kpack.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - images
</span></span></span><span class="line"><span class="cl"><span class="s">  - builds
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;scanning.apps.tanzu.vmware.com&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - sourcescans
</span></span></span><span class="line"><span class="cl"><span class="s">  - imagescans
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;tekton.dev&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - taskruns
</span></span></span><span class="line"><span class="cl"><span class="s">  - pipelineruns
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">- apiGroups: [&#39;kappctrl.k14s.io&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">  resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  - apps
</span></span></span><span class="line"><span class="cl"><span class="s">  verbs: [&#39;get&#39;, &#39;watch&#39;, &#39;list&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>모든 클러스터에 개발자의 대한 권한을 부여</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl annotate secret tap-registry -n tap-install secretgen.carvel.dev/image-pull-secret<span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl patch sa default -n tap-install --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;add&#34;,&#34;path&#34;:&#34;/secrets&#34;,&#34;value&#34;:[&#34;name&#34;:&#34;registry-credentials&#34;,&#34;name&#34;:&#34;tap-registry&#34;]}]&#39;</span>
</span></span><span class="line"><span class="cl">kubectl patch sa default -n tap-install --type <span class="s1">&#39;json&#39;</span> -p <span class="s1">&#39;[{&#34;op&#34;:&#34;add&#34;,&#34;path&#34;:&#34;/imagePullSecrets&#34;,&#34;value&#34;:[&#34;name&#34;:&#34;registry-credentials&#34;,&#34;name&#34;:&#34;tap-registry&#34;]}]&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl apply -f - -n tap-install <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default-permit-deliverable
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: deliverable
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: default-permit-workload
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: workload
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: ServiceAccount
</span></span></span><span class="line"><span class="cl"><span class="s">    name: default
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: RoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: dev-permit-app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: Group
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#34;namespace-developers&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">---
</span></span></span><span class="line"><span class="cl"><span class="s">apiVersion: rbac.authorization.k8s.io/v1
</span></span></span><span class="line"><span class="cl"><span class="s">kind: ClusterRoleBinding
</span></span></span><span class="line"><span class="cl"><span class="s">metadata:
</span></span></span><span class="line"><span class="cl"><span class="s">  name: namespace-dev-permit-app-viewer
</span></span></span><span class="line"><span class="cl"><span class="s">roleRef:
</span></span></span><span class="line"><span class="cl"><span class="s">  apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">  kind: ClusterRole
</span></span></span><span class="line"><span class="cl"><span class="s">  name: app-viewer-cluster-access
</span></span></span><span class="line"><span class="cl"><span class="s">subjects:
</span></span></span><span class="line"><span class="cl"><span class="s">  - kind: Group
</span></span></span><span class="line"><span class="cl"><span class="s">    name: &#34;namespace-developers&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    apiGroup: rbac.authorization.k8s.io
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Build Cluster로 컨텍스트 변경 후 App을 배포한다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">DEVELOPER_NAMESPACE</span><span class="o">=</span>tap-install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tanzu apps workload create tanzu-java-web-app <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --git-repo https://github.com/huntedhappy/tanzu-java-web-app <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --git-branch main <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --type web <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --label app.kubernetes.io/part-of<span class="o">=</span>tanzu-java-web-app <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --yes <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> -n <span class="si">${</span><span class="nv">DEVELOPER_NAMESPACE</span><span class="si">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<figure><figcaption>
            <h4>app workload 상태 확인</h4>
        </figcaption>
</figure>

<ul>
<li>진행 상태 확인</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">tanzu apps workload tail tanzu-java-web-app --since 10m --timestamp -n <span class="si">${</span><span class="nv">DEVELOPER_NAMESPACE</span><span class="si">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>app workload 진행 상태 확인</h4>
        </figcaption>
</figure>

<ul>
<li>
<p>생성이 완료 되면 GUI에서 확인
<figure><figcaption>
            <h4>supply chain 확인</h4>
        </figcaption>
</figure>
</p>
</li>
<li>
<p>deliverable이 되었는지 확인 한다. build 클러스터에서는 false로 나오는 것을 우선 확인 할 수 있다.</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get deliverable -n <span class="si">${</span><span class="nv">DEVELOPER_NAMESPACE</span><span class="si">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>deliverable 실패 확인</h4>
        </figcaption>
</figure>

<ul>
<li>deliverable를 yaml파일로 저장한다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get deliverable tanzu-java-web-app -n <span class="si">${</span><span class="nv">DEVELOPER_NAMESPACE</span><span class="si">}</span> -oyaml &gt; deliverable.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>저장된 파일에서 ownerReferences와 status 부분을 삭제 한다. 그럼 아래와 비슷할 것이다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">apiVersion: carto.run/v1alpha1
</span></span><span class="line"><span class="cl">kind: Deliverable
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  creationTimestamp: <span class="s2">&#34;2022-04-19T07:56:37Z&#34;</span>
</span></span><span class="line"><span class="cl">  generation: <span class="m">1</span>
</span></span><span class="line"><span class="cl">  labels:
</span></span><span class="line"><span class="cl">    app.kubernetes.io/component: deliverable
</span></span><span class="line"><span class="cl">    app.kubernetes.io/part-of: tanzu-java-web-app
</span></span><span class="line"><span class="cl">    app.tanzu.vmware.com/deliverable-type: web
</span></span><span class="line"><span class="cl">    apps.tanzu.vmware.com/workload-type: web
</span></span><span class="line"><span class="cl">    carto.run/cluster-template-name: deliverable-template
</span></span><span class="line"><span class="cl">    carto.run/resource-name: deliverable
</span></span><span class="line"><span class="cl">    carto.run/supply-chain-name: source-to-url
</span></span><span class="line"><span class="cl">    carto.run/template-kind: ClusterTemplate
</span></span><span class="line"><span class="cl">    carto.run/workload-name: tanzu-java-web-app
</span></span><span class="line"><span class="cl">    carto.run/workload-namespace: tap-install
</span></span><span class="line"><span class="cl">  name: tanzu-java-web-app
</span></span><span class="line"><span class="cl">  namespace: tap-install
</span></span><span class="line"><span class="cl">  resourceVersion: <span class="s2">&#34;1451190&#34;</span>
</span></span><span class="line"><span class="cl">  uid: 23c2d202-0186-4c62-b497-baaa961e3698
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  source:
</span></span><span class="line"><span class="cl">    image: <span class="o">{</span>image<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>run cluster로 변경 후 저장한 deliverable파일을 실행 해준다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## RUN Cluster로 변경</span>
</span></span><span class="line"><span class="cl">kubectl config use-context <span class="o">{</span>run cluster<span class="o">}</span>
</span></span><span class="line"><span class="cl">kubectl apply -f deliverable.yaml -n <span class="si">${</span><span class="nv">DEVELOPER_NAMESPACE</span><span class="si">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>확인을 하면 성공한 것을 확인 할 수 있다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get deliverables -n <span class="si">${</span><span class="nv">DEVELOPER_NAMESPACE</span><span class="si">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>deliverable 상태 확인</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>deliverable gui 상태 확인</h4>
        </figcaption>
</figure>
</p>
<h2 id="4-visual-studio">4. Visual Studio</h2>
<p>IDE를 Visual Studio를 사용하여 동작, 현재는 Visual studio만 지원 하고 있음</p>
<h3 id="41-extenstion-설정">4.1. Extenstion 설정</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">apt search openjdk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">apt install openjdk-11-jdk -y
</span></span><span class="line"><span class="cl">java --version
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;allow_k8s_contexts(&#39;</span><span class="k">$(</span>kubectl config current-context<span class="k">)</span><span class="s2">&#39;)&#34;</span> &gt;&gt; /var/tmp/tap/tanzu-java-web-app/Tiltfile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 맨아래 해당 context가 들어가 있는 것을 확인 할 수 있다.</span>
</span></span><span class="line"><span class="cl">cat /var/tmp/tap/tanzu-java-web-app/Tiltfile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ctrl + <span class="nb">shift</span> + p
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>VS 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>VS 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>VS 설정</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>VS 설정</h4>
        </figcaption>
</figure>
</p>
<h3 id="42-live-update-start">4.2. Live Update Start</h3>
<p>해당 부분을 수정 하면 자동으로 GIT에 업데이트가 되면서 바뀌는것을 볼수 있다.
<figure><figcaption>
            <h4>수정#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>수정#2</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>수정#3</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>수정#4</h4>
        </figcaption>
</figure>
</p>
]]></description>
</item><item>
    <title>The Documentation Practics</title>
    <link>https://huntedhappy.github.io/ko/pratics/</link>
    <pubDate>Thu, 20 Jan 2022 23:06:47 &#43;0900</pubDate>
    <author>Author</author>
    <guid>https://huntedhappy.github.io/ko/pratics/</guid>
    <description><![CDATA[<p>본 문서는 코딩 따라하기 테스트 페이지, 제가 다른 문서를 참조해서 따라해보는 페이지 입니다.</p>
<h2 id="1-nginx--php--mysql-연동">1. NGINX + PHP + MYSQL 연동</h2>
<p>환경</p>
<ul>
<li>UBUNTU: VERSION=&ldquo;20.04.3 LTS (Focal Fossa)&rdquo;</li>
<li>MYSQL: mysql  Ver 8.0.28 for Linux on x86_64 (MySQL Community Server - GPL)</li>
<li>PHP: PHP 7.4.3 (cli) (built: Nov 25 2021 23:16:22) ( NTS )</li>
<li>NGINX: nginx version: nginx/1.20.2</li>
</ul>
<hr>
<p>사전 지식</p>
<ul>
<li>NGINX</li>
<li>MYSQL</li>
<li>PHP</li>
</ul>
<h4 id="pdo">PDO</h4>
<p>PDO(PHP Data Objects)란 여러가지 데이터베이스를 제어하는 방법을 표준화시킨 것이다. 데이터베이스는 다양한 종류가 있다. 그리고 종류에 따라서 서로 다른 드라이브를 사용해 왔는데 드라이브의 종류에 따라서 데이터베이스를 제어하기 위한 API가 달랐다. PDO를 사용하면 동일한 방법으로 데이터베이스를 제어할 수 있다.</p>
<p>PDO를 사용하기 위해서는</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## 해당 파일에서</span>
</span></span><span class="line"><span class="cl">vi /etc/php/7.4/fpm/php.ini
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 아래 pdo_mysql 주석을 제거 한다.</span>
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="nv">extension</span><span class="o">=</span>pdo_firebird
</span></span><span class="line"><span class="cl"><span class="nv">extension</span><span class="o">=</span>pdo_mysql
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="nv">extension</span><span class="o">=</span>pdo_oci
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="nv">extension</span><span class="o">=</span>pdo_odbc
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="nv">extension</span><span class="o">=</span>pdo_pgsql
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="nv">extension</span><span class="o">=</span>pdo_sqlite
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw"></i>mysql 사전 작업<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">## 데이터베이스(스키마) 생성</span>
</span></span><span class="line"><span class="cl">CREATE DATABASE opentutorials CHARACTER SET utf8 COLLATE utf8_general_ci<span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 설정 할 스키마 선택</span>
</span></span><span class="line"><span class="cl">use opentutorials<span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## TABLE 생성</span>
</span></span><span class="line"><span class="cl">CREATE TABLE topic <span class="o">(</span>
</span></span><span class="line"><span class="cl">    id  int<span class="o">(</span>11<span class="o">)</span> NOT NULL AUTO_INCREMENT,
</span></span><span class="line"><span class="cl">    title  varchar<span class="o">(</span>255<span class="o">)</span> NOT NULL ,
</span></span><span class="line"><span class="cl">    description  text NULL ,
</span></span><span class="line"><span class="cl">    created  datetime NOT NULL ,
</span></span><span class="line"><span class="cl">    PRIMARY KEY <span class="o">(</span>id<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<div class="details admonition example open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw"></i>PHP 구성<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>input.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;!</span><span class="nx">DOCTYPE</span> <span class="nx">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">charset</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;./process.php?mode=insert&#34;</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;POST&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">제목</span> <span class="o">:</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;title&#34;</span><span class="o">&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">본문</span> <span class="o">:</span> <span class="o">&lt;</span><span class="nx">textarea</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;description&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nx">cols</span><span class="o">=</span><span class="s2">&#34;30&#34;</span> <span class="nx">rows</span><span class="o">=</span><span class="s2">&#34;10&#34;</span><span class="o">&gt;&lt;/</span><span class="nx">textarea</span><span class="o">&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;submit&#34;</span> <span class="o">/&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="nx">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>process.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=localhost;dbname=opentutorials&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;111111&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="nx">PDO</span><span class="o">::</span><span class="na">MYSQL_ATTR_INIT_COMMAND</span> <span class="o">=&gt;</span> <span class="s2">&#34;SET NAMES utf8&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="k">switch</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]){</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;insert&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&#34;INSERT INTO topic (title, description, created) VALUES (:title, :description, now())&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:title&#39;</span><span class="p">,</span><span class="nv">$title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:description&#39;</span><span class="p">,</span><span class="nv">$description</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="nv">$title</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$description</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: list.php&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">&#39;DELETE FROM topic WHERE id = :id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: list.php&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;modify&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">&#39;UPDATE topic SET title = :title, description = :description WHERE id = :id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:title&#39;</span><span class="p">,</span> <span class="nv">$title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:description&#39;</span><span class="p">,</span> <span class="nv">$description</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="nv">$title</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$description</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: list.php?id=</span><span class="si">{</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>list.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=localhost;dbname=opentutorials&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;111111&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM topic&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$list</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetchAll</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM topic WHERE id = :id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">,</span> <span class="nx">PDO</span><span class="o">::</span><span class="na">PARAM_INT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$topic</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;meta charset=&#34;utf-8&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;style type=&#34;text/css&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            body {
</span></span></span><span class="line"><span class="cl"><span class="err">                font-size: 0.8em;
</span></span></span><span class="line"><span class="cl"><span class="err">                font-family: dotum;
</span></span></span><span class="line"><span class="cl"><span class="err">                line-height: 1.6em;
</span></span></span><span class="line"><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="cl"><span class="err">            header {
</span></span></span><span class="line"><span class="cl"><span class="err">                border-bottom: 1px solid #ccc;
</span></span></span><span class="line"><span class="cl"><span class="err">                padding: 20px 0;
</span></span></span><span class="line"><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="cl"><span class="err">            nav {
</span></span></span><span class="line"><span class="cl"><span class="err">                float: left;
</span></span></span><span class="line"><span class="cl"><span class="err">                margin-right: 20px;
</span></span></span><span class="line"><span class="cl"><span class="err">                min-height: 1000px;
</span></span></span><span class="line"><span class="cl"><span class="err">                min-width:150px;
</span></span></span><span class="line"><span class="cl"><span class="err">                border-right: 1px solid #ccc;
</span></span></span><span class="line"><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="cl"><span class="err">            nav ul {
</span></span></span><span class="line"><span class="cl"><span class="err">                list-style: none;
</span></span></span><span class="line"><span class="cl"><span class="err">                padding-left: 0;
</span></span></span><span class="line"><span class="cl"><span class="err">                padding-right: 20px;
</span></span></span><span class="line"><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="cl"><span class="err">            article {
</span></span></span><span class="line"><span class="cl"><span class="err">                float: left;
</span></span></span><span class="line"><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="cl"><span class="err">            .description{
</span></span></span><span class="line"><span class="cl"><span class="err">                width:500px;
</span></span></span><span class="line"><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/style&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">   
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;body id=&#34;body&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;div&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;nav&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;ul&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                    &lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">                    foreach($list as $row) {
</span></span></span><span class="line"><span class="cl"><span class="err">                        echo &#34;&lt;li&gt;&lt;a href=\&#34;?id={$row[&#39;id&#39;]}\&#34;&gt;&#34;.htmlspecialchars($row[&#39;title&#39;]).&#34;&lt;/a&gt;&lt;/li&gt;&#34;;                        }
</span></span></span><span class="line"><span class="cl"><span class="err">                    ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;/ul&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;ul&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                    &lt;li&gt;&lt;a href=&#34;input.php&#34;&gt;추가&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;/ul&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;/nav&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;article&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">                if(!empty($topic)){
</span></span></span><span class="line"><span class="cl"><span class="err">                ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;h2&gt;&lt;?=htmlspecialchars($topic[&#39;title&#39;])?&gt;&lt;/h2&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;div class=&#34;description&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                    &lt;?=htmlspecialchars($topic[&#39;description&#39;])?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;div&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                    &lt;a href=&#34;modify.php?id=&lt;?=$topic[&#39;id&#39;]?&gt;&#34;&gt;수정&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                    &lt;form method=&#34;POST&#34; action=&#34;process.php?mode=delete&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                        &lt;input type=&#34;hidden&#34; name=&#34;id&#34; value=&#34;&lt;?=$topic[&#39;id&#39;]?&gt;&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                        &lt;input type=&#34;submit&#34; value=&#34;삭제&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                    &lt;/form&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">                ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;/article&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/html&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>modify.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=localhost;dbname=opentutorials&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;111111&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM topic WHERE id = :id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindParam</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">,</span> <span class="nx">PDO</span><span class="o">::</span><span class="na">PARAM_INT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$topic</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;meta charset=&#34;utf-8&#34;/&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;/head&gt;   
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;form action=&#34;./process.php?mode=modify&#34; method=&#34;POST&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;input type=&#34;hidden&#34; name=&#34;id&#34; value=&#34;&lt;?=$topic[&#39;id&#39;]?&gt;&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;p&gt;제목 : &lt;input type=&#34;text&#34; name=&#34;title&#34; value=&#34;&lt;?=htmlspecialchars($topic[&#39;title&#39;])?&gt;&#34;&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;p&gt;본문 : &lt;textarea name=&#34;description&#34; id=&#34;&#34; cols=&#34;30&#34; rows=&#34;10&#34;&gt;&lt;?=htmlspecialchars($topic[&#39;description&#39;])?&gt;&lt;/textarea&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;p&gt;&lt;input type=&#34;submit&#34; /&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/form&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/html&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p>웹 접속 후 입력을 하게 되면
<figure><figcaption>
            <h4>입력#1</h4>
        </figcaption>
</figure>
</p>
<p>리스트에 추가가 된 것을 확인 할 수 있으며
<figure><figcaption>
            <h4>입력#2</h4>
        </figcaption>
</figure>
</p>
<p>아래와 같이 DB에 추가 된 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>LIST</h4>
        </figcaption>
</figure>
</p>
<p>그리고 수정을 하게 되면
<figure><figcaption>
            <h4>수정#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>수정#2</h4>
        </figcaption>
</figure>
</p>
<p>DB에서도 수정이 되는 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>수정#3</h4>
        </figcaption>
</figure>
</p>
<p><a href="https://opentutorials.org/module/6/5155" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> 자료출처: 생활코딩</a></p>
<h2 id="2-golang">2. GOLANG</h2>
<p><a href="https://pkg.go.dev/fmt" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> fmt link</a></p>
<h3 id="21-hello-world">2.1. Hello World</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nb">println</span><span class="p">(</span><span class="s">&#34;Hello World&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>Hello World</h4>
        </figcaption>
</figure>

<h3 id="22-const">2.2. Const</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">conferenceName</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Welcome to&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">,</span> <span class="s">&#34;booking application&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">30</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">conferenceTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>const로 정의를 하면 아래처럼 값을 변경 할 수 없다.
<figure><figcaption>
            <h4>const</h4>
        </figcaption>
</figure>
</p>
<p>var로 변경을 하면 아래에서 30으로 변경이 가능하다.
<figure><figcaption>
            <h4>var 변경</h4>
        </figcaption>
</figure>
</p>
<h3 id="23-printf">2.3. printf</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">conferenceName</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>printf#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>printf#2</h4>
        </figcaption>
</figure>
</p>
<h3 id="24-data-type">2.4. Data Type</h3>
<p><a href="https://www.tutorialspoint.com/go/go_data_types.htm" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> Golang DataType</a></p>
<p>설정한 DataType을 확인 할 수 있다.
fmt.Printf(&ldquo;Welcome to %T booking application\n&rdquo;, conferenceName)</p>
<p>var conferenceName = &ldquo;Go Confernece&rdquo; -&gt; conferenceName := &ldquo;Go Conference&rdquo; 로 하면 알아서 타입을 변경 해준다. 만약 숫자를 집어 넣으면 알아서 int로 변경을 해줌</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">conferenceName</span> <span class="o">:=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;conferenceTickets is %T, remainingTickets is %T, conferencename is %T\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">userName</span> <span class="p">=</span> <span class="s">&#34;TOM&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">userTickets</span> <span class="p">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;User %v booked %v tickets.\n&#34;</span><span class="p">,</span> <span class="nx">userName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><figcaption>
            <h4>datatype#1</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>datatype#2</h4>
        </figcaption>
</figure>
</p>
<p>%T로 했을 경우 DataType을 확인 할 수 있다.
<figure><figcaption>
            <h4>datatype#3</h4>
        </figcaption>
</figure>

<figure><figcaption>
            <h4>datatype#4</h4>
        </figcaption>
</figure>
</p>
<h3 id="24-input-포인터를-사용해야한다">2.4. INPUT, 포인터를 사용해야한다.</h3>
<p>&amp; &lt;- 포인터를 사용
fmt.Scan(&amp;useraName) 을하면 사용자가 입력을 할 수 있게 해준다.
포인터를 사용하지 않을 경우 저장된 메모리 값을 확인 할 수 있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">conferenceName</span> <span class="o">:=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;conferenceTickets is %T, remainingTickets is %T, conferencename is %T\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>                       <span class="c1">// 이지점에서 사용자에게 물어봄
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>                        <span class="c1">// 이지점에서 사용자에게 물어봄
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>                           <span class="c1">// 이지점에서 사용자에게 물어봄
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>                     <span class="c1">// 이지점에서 사용자에게 물어봄
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>input</h4>
        </figcaption>
</figure>

<h3 id="25-array">2.5. Array</h3>
<p>배열의 경우 공간중간 값이 없어도 빈공간으로 인식을 하기 때문에 메모리를 그만큼 할당 하게 된다.</p>
<p>배열 2가지가 추가됨</p>
<p>var bookings [50]string</p>
<p>bookings[0] = firstName + &quot; &quot; + lastName</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">conferenceName</span> <span class="o">:=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">bookings</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span><span class="kt">string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;conferenceTickets is %T, remainingTickets is %T, conferencename is %T\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">=</span> <span class="nx">firstName</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="nx">lastName</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The whole array: %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first value: %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first value: %T\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first value: %v\n&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">bookings</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>공간이 이미 할당이 되어 있는 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>array</h4>
        </figcaption>
</figure>
</p>
<h3 id="26-slice">2.6. Slice</h3>
<p>Slice구성 아래 2가지가 변경되고 하나 추가됨.
var bookings [50]string -&gt; bookings := []string{}</p>
<p>bookings[0] = firstName + &quot; &quot; + lastName -&gt;  bookings = append(bookings, firstName + &quot; &quot; + lastName)</p>
<p>fmt.Printf(&ldquo;These are all our booking: %v\n&rdquo;, bookings)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">conferenceName</span> <span class="o">:=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;conferenceTickets is %T, remainingTickets is %T, conferencename is %T\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">firstName</span><span class="o">+</span><span class="s">&#34; &#34;</span><span class="o">+</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The whole slice: %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first value: %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first type: %T\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first lgenth: %v\n&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">bookings</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;These are all our booking: %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>작성한 값만 들어가 있는 것을 확인 할 수 있다.
<figure><figcaption>
            <h4>slice</h4>
        </figcaption>
</figure>
</p>
<h3 id="27-loop--if">2.7 Loop &amp; If</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">conferenceName</span> <span class="o">:=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;conferenceTickets is %T, remainingTickets is %T, conferencename is %T\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">firstName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">lastName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidEmail</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="s">&#34;@&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nx">userTickets</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">userTickets</span> <span class="o">&lt;=</span> <span class="nx">remainingTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">			<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">firstName</span><span class="o">+</span><span class="s">&#34; &#34;</span><span class="o">+</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="kd">var</span> <span class="nx">names</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Fields</span><span class="p">(</span><span class="nx">booking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;These first names of bookings are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="28-function">2.8. function</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">conferenceName</span> <span class="o">:=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">(</span><span class="nx">conferenceName</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">firstName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">lastName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidEmail</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="s">&#34;@&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nx">userTickets</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">userTickets</span> <span class="o">&lt;=</span> <span class="nx">remainingTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">			<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">firstName</span><span class="o">+</span><span class="s">&#34; &#34;</span><span class="o">+</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">printFirstNames</span><span class="p">(</span><span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">(</span><span class="nx">confName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">confTickets</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">confName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">confTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">printFirstNames</span><span class="p">(</span><span class="nx">bookings</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">names</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Fields</span><span class="p">(</span><span class="nx">booking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;These first names of bookings are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="29-return-func">2.9. return func</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">names</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Fields</span><span class="p">(</span><span class="nx">booking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidName</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">firstName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">lastName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidEmail</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="s">&#34;@&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nx">userTickets</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">userTickets</span> <span class="o">&lt;=</span> <span class="nx">remainingTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">firstName</span><span class="o">+</span><span class="s">&#34; &#34;</span><span class="o">+</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="210-package">2.10. package</h3>
<p>helper.go 파일 생성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">package main
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">import <span class="s2">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func validateUserInput<span class="o">(</span>firstName string, lastName string, email string, userTickets uint<span class="o">)</span> <span class="o">(</span>bool, bool, bool<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	isValidName :<span class="o">=</span> len<span class="o">(</span>firstName<span class="o">)</span> &gt;<span class="o">=</span> <span class="m">2</span> <span class="o">&amp;&amp;</span> len<span class="o">(</span>lastName<span class="o">)</span> &gt;<span class="o">=</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">	isValidEmail :<span class="o">=</span> strings.Contains<span class="o">(</span>email, <span class="s2">&#34;@&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">	isValidTicketNumber :<span class="o">=</span> userTickets &gt; <span class="m">0</span> <span class="o">&amp;&amp;</span> userTickets &lt;<span class="o">=</span> remainingTickets
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> isValidName, isValidEmail, isValidTicketNumber
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>main.go</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">names</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Fields</span><span class="p">(</span><span class="nx">booking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">firstName</span><span class="o">+</span><span class="s">&#34; &#34;</span><span class="o">+</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="211-multi-package">2.11. multi package</h3>
<p>helper.go</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">helper</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">ValidateUserInput</span><span class="p">(</span><span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidName</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">firstName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">lastName</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidEmail</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="s">&#34;@&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nx">userTickets</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">userTickets</span> <span class="o">&lt;=</span> <span class="nx">remainingTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>main.go</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;GOLANG/helper&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nx">helper</span><span class="p">.</span><span class="nf">ValidateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">names</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Fields</span><span class="p">(</span><span class="nx">booking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">firstName</span><span class="o">+</span><span class="s">&#34; &#34;</span><span class="o">+</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>multi pacakge</h4>
        </figcaption>
</figure>

<h3 id="212-maps">2.12. MAPS</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strconv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="nb">make</span><span class="p">([]</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">booking</span><span class="p">[</span><span class="s">&#34;firtName&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userData</span> <span class="p">=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">userData</span><span class="p">[</span><span class="s">&#34;firstName&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">firstName</span>
</span></span><span class="line"><span class="cl">	<span class="nx">userData</span><span class="p">[</span><span class="s">&#34;lastName&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">lastName</span>
</span></span><span class="line"><span class="cl">	<span class="nx">userData</span><span class="p">[</span><span class="s">&#34;email&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">email</span>
</span></span><span class="line"><span class="cl">	<span class="nx">userData</span><span class="p">[</span><span class="s">&#34;numberOfTickets&#34;</span><span class="p">]</span> <span class="p">=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">FormatUint</span><span class="p">(</span><span class="nb">uint64</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">userData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;List of bookings is %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>maps</h4>
        </figcaption>
</figure>

<h3 id="213-struct">2.13. struct</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="nb">make</span><span class="p">([]</span><span class="nx">UserData</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">UserData</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstName</span>       <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">lastName</span>        <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">email</span>           <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">numberOfTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">booking</span><span class="p">.</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userData</span> <span class="p">=</span> <span class="nx">UserData</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">:</span>       <span class="nx">firstName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">lastName</span><span class="p">:</span>        <span class="nx">lastName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">email</span><span class="p">:</span>           <span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">numberOfTickets</span><span class="p">:</span> <span class="nx">userTickets</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">userData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;List of bookings is %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>struct</h4>
        </figcaption>
</figure>

<h3 id="214-long-processing-task">2.14. long processing task</h3>
<p>메일을 보내는 10초간 기다리게 구성</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;time&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="nb">make</span><span class="p">([]</span><span class="nx">UserData</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">UserData</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstName</span>       <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">lastName</span>        <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">email</span>           <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">numberOfTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nf">sendTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">booking</span><span class="p">.</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userData</span> <span class="p">=</span> <span class="nx">UserData</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">:</span>       <span class="nx">firstName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">lastName</span><span class="p">:</span>        <span class="nx">lastName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">email</span><span class="p">:</span>           <span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">numberOfTickets</span><span class="p">:</span> <span class="nx">userTickets</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">userData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;List of bookings is %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">sendTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">ticket</span> <span class="p">=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%v tickets for %v %v&#34;</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;#########################&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Sending ticket: \n %v to email address %v\n&#34;</span><span class="p">,</span> <span class="nx">ticket</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;#########################&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><figcaption>
            <h4>long processing</h4>
        </figcaption>
</figure>

<h3 id="215-비동기">2.15. 비동기</h3>
<p>메일을 기다리지 않고 보내면서 메일은 별도로 보내지게 구성 한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;time&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="nb">make</span><span class="p">([]</span><span class="nx">UserData</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">UserData</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstName</span>       <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">lastName</span>        <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">email</span>           <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">numberOfTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1">// go라는 것을 넣어주면 된다.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="k">go</span> <span class="nf">sendTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">booking</span><span class="p">.</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userData</span> <span class="p">=</span> <span class="nx">UserData</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">:</span>       <span class="nx">firstName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">lastName</span><span class="p">:</span>        <span class="nx">lastName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">email</span><span class="p">:</span>           <span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">numberOfTickets</span><span class="p">:</span> <span class="nx">userTickets</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">userData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;List of bookings is %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">sendTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">ticket</span> <span class="p">=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%v tickets for %v %v&#34;</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;#########################&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Sending ticket: \n %v to email address %v\n&#34;</span><span class="p">,</span> <span class="nx">ticket</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;#########################&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="116-동기">1.16. 동기</h3>
<p>sync 함수를 사용한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;sync&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;time&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="nx">conferenceTickets</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">conferenceName</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;Go Conference&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">remainingTickets</span> <span class="kt">uint</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">bookings</span> <span class="p">=</span> <span class="nb">make</span><span class="p">([]</span><span class="nx">UserData</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">UserData</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstName</span>       <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">lastName</span>        <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">email</span>           <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">numberOfTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">wg</span> <span class="p">=</span> <span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">greetUsers</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">//for {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span> <span class="o">:=</span> <span class="nf">getUserInput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isValidName</span><span class="p">,</span> <span class="nx">isValidEmail</span><span class="p">,</span> <span class="nx">isValidTicketNumber</span> <span class="o">:=</span> <span class="nf">validateUserInput</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">isValidName</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidEmail</span> <span class="o">&amp;&amp;</span> <span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">wg</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">go</span> <span class="nf">sendTicket</span><span class="p">(</span><span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="o">:=</span> <span class="nf">getFirstNames</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;The first names of bookins are: %v\n&#34;</span><span class="p">,</span> <span class="nx">firstNames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">remainingTickets</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Our conference is booked out. Come back next year.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="c1">//break
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">!</span><span class="nx">isValidName</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;first name or last name you entered is too short&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">!</span><span class="nx">isValidEmail</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;email address you entered doesn&#39;t contain @ sign&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">!</span><span class="nx">isValidTicketNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;number of tickets you entered is invalid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">wg</span><span class="p">.</span><span class="nf">Wait</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">greetUsers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Welcome to %v booking application\n&#34;</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;We have total of %v tickets and %v are still available\n&#34;</span><span class="p">,</span> <span class="nx">conferenceTickets</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Get your tickets here to attend&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getFirstNames</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">firstNames</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">booking</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">bookings</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstNames</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">firstNames</span><span class="p">,</span> <span class="nx">booking</span><span class="p">.</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstNames</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">getUserInput</span><span class="p">()</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">firstName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">lastName</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">email</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userTickets</span> <span class="kt">uint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your firstName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your lastName: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter Your email: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Enter number of tickets: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Scan</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">userTickets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">bookTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">remainingTickets</span> <span class="p">=</span> <span class="nx">remainingTickets</span> <span class="o">-</span> <span class="nx">userTickets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">userData</span> <span class="p">=</span> <span class="nx">UserData</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">firstName</span><span class="p">:</span>       <span class="nx">firstName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">lastName</span><span class="p">:</span>        <span class="nx">lastName</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">email</span><span class="p">:</span>           <span class="nx">email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">numberOfTickets</span><span class="p">:</span> <span class="nx">userTickets</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">bookings</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">bookings</span><span class="p">,</span> <span class="nx">userData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;List of bookings is %v\n&#34;</span><span class="p">,</span> <span class="nx">bookings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Thank you %v %v for booking %v tickets. You will receive a confirmation email at %v\n&#34;</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%v tickets remaining for %v\n&#34;</span><span class="p">,</span> <span class="nx">remainingTickets</span><span class="p">,</span> <span class="nx">conferenceName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">sendTicket</span><span class="p">(</span><span class="nx">userTickets</span> <span class="kt">uint</span><span class="p">,</span> <span class="nx">firstName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">lastName</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">ticket</span> <span class="p">=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%v tickets for %v %v&#34;</span><span class="p">,</span> <span class="nx">userTickets</span><span class="p">,</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;#########################&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Sending ticket: \n %v to email address %v\n&#34;</span><span class="p">,</span> <span class="nx">ticket</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;#########################&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">wg</span><span class="p">.</span><span class="nf">Done</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://youtu.be/yyUHQIec83I" target="_blank" rel="noopener noreffer"><i class="fas fa-link"></i> 참고동영상: TechWorld with Nana</a></p>
]]></description>
</item></channel>
</rss>
